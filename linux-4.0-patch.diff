diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/aes_generic.c linux-4.0.orig/crypto/aes_generic.c
--- linux-4.0/crypto/aes_generic.c	2015-04-20 21:09:49.876122608 +0100
+++ linux-4.0.orig/crypto/aes_generic.c	2015-04-12 23:12:50.000000000 +0100
@@ -1469,7 +1469,7 @@ static void __exit aes_fini(void)
 	crypto_unregister_alg(&aes_alg);
 }
 
-async_module_init(aes_init);
+module_init(aes_init);
 module_exit(aes_fini);
 
 MODULE_DESCRIPTION("Rijndael (AES) Cipher Algorithm");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/ansi_cprng.c linux-4.0.orig/crypto/ansi_cprng.c
--- linux-4.0/crypto/ansi_cprng.c	2015-04-20 21:09:49.884122608 +0100
+++ linux-4.0.orig/crypto/ansi_cprng.c	2015-04-12 23:12:50.000000000 +0100
@@ -474,7 +474,7 @@ MODULE_DESCRIPTION("Software Pseudo Rand
 MODULE_AUTHOR("Neil Horman <nhorman@tuxdriver.com>");
 module_param(dbg, int, 0);
 MODULE_PARM_DESC(dbg, "Boolean to enable debugging (0/1 == off/on)");
-async_module_init(prng_mod_init);
+module_init(prng_mod_init);
 module_exit(prng_mod_fini);
 MODULE_ALIAS_CRYPTO("stdrng");
 MODULE_ALIAS_CRYPTO("ansi_cprng");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/asymmetric_keys/asymmetric_type.c linux-4.0.orig/crypto/asymmetric_keys/asymmetric_type.c
--- linux-4.0/crypto/asymmetric_keys/asymmetric_type.c	2015-04-20 21:09:49.892122608 +0100
+++ linux-4.0.orig/crypto/asymmetric_keys/asymmetric_type.c	2015-04-12 23:12:50.000000000 +0100
@@ -402,5 +402,5 @@ static void __exit asymmetric_key_cleanu
 	unregister_key_type(&key_type_asymmetric);
 }
 
-async_module_init(asymmetric_key_init);
+module_init(asymmetric_key_init);
 module_exit(asymmetric_key_cleanup);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/asymmetric_keys/pkcs7_key_type.c linux-4.0.orig/crypto/asymmetric_keys/pkcs7_key_type.c
--- linux-4.0/crypto/asymmetric_keys/pkcs7_key_type.c	2015-04-20 21:09:49.895122608 +0100
+++ linux-4.0.orig/crypto/asymmetric_keys/pkcs7_key_type.c	2015-04-12 23:12:50.000000000 +0100
@@ -94,5 +94,5 @@ static void __exit pkcs7_key_cleanup(voi
 	unregister_key_type(&key_type_pkcs7);
 }
 
-async_module_init(pkcs7_key_init);
+module_init(pkcs7_key_init);
 module_exit(pkcs7_key_cleanup);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/asymmetric_keys/x509_public_key.c linux-4.0.orig/crypto/asymmetric_keys/x509_public_key.c
--- linux-4.0/crypto/asymmetric_keys/x509_public_key.c	2015-04-20 21:09:49.906122608 +0100
+++ linux-4.0.orig/crypto/asymmetric_keys/x509_public_key.c	2015-04-12 23:12:50.000000000 +0100
@@ -357,7 +357,7 @@ static void __exit x509_key_exit(void)
 	unregister_asymmetric_key_parser(&x509_key_parser);
 }
 
-async_module_init(x509_key_init);
+module_init(x509_key_init);
 module_exit(x509_key_exit);
 
 MODULE_DESCRIPTION("X.509 certificate parser");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/blowfish_generic.c linux-4.0.orig/crypto/blowfish_generic.c
--- linux-4.0/crypto/blowfish_generic.c	2015-04-20 21:09:49.909122608 +0100
+++ linux-4.0.orig/crypto/blowfish_generic.c	2015-04-12 23:12:50.000000000 +0100
@@ -133,7 +133,7 @@ static void __exit blowfish_mod_fini(voi
 	crypto_unregister_alg(&alg);
 }
 
-async_module_init(blowfish_mod_init);
+module_init(blowfish_mod_init);
 module_exit(blowfish_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/cbc.c linux-4.0.orig/crypto/cbc.c
--- linux-4.0/crypto/cbc.c	2015-04-20 21:09:49.912122608 +0100
+++ linux-4.0.orig/crypto/cbc.c	2015-04-12 23:12:50.000000000 +0100
@@ -284,7 +284,7 @@ static void __exit crypto_cbc_module_exi
 	crypto_unregister_template(&crypto_cbc_tmpl);
 }
 
-async_module_init(crypto_cbc_module_init);
+module_init(crypto_cbc_module_init);
 module_exit(crypto_cbc_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/crc32.c linux-4.0.orig/crypto/crc32.c
--- linux-4.0/crypto/crc32.c	2015-04-20 21:09:49.915122608 +0100
+++ linux-4.0.orig/crypto/crc32.c	2015-04-12 23:12:50.000000000 +0100
@@ -150,7 +150,7 @@ static void __exit crc32_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-async_module_init(crc32_mod_init);
+module_init(crc32_mod_init);
 module_exit(crc32_mod_fini);
 
 MODULE_AUTHOR("Alexander Boyko <alexander_boyko@xyratex.com>");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/crc32c_generic.c linux-4.0.orig/crypto/crc32c_generic.c
--- linux-4.0/crypto/crc32c_generic.c	2015-04-20 21:09:49.917122608 +0100
+++ linux-4.0.orig/crypto/crc32c_generic.c	2015-04-12 23:12:50.000000000 +0100
@@ -164,7 +164,7 @@ static void __exit crc32c_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-async_module_init(crc32c_mod_init);
+module_init(crc32c_mod_init);
 module_exit(crc32c_mod_fini);
 
 MODULE_AUTHOR("Clay Haapala <chaapala@cisco.com>");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/crct10dif_generic.c linux-4.0.orig/crypto/crct10dif_generic.c
--- linux-4.0/crypto/crct10dif_generic.c	2015-04-20 21:09:49.920122608 +0100
+++ linux-4.0.orig/crypto/crct10dif_generic.c	2015-04-12 23:12:50.000000000 +0100
@@ -118,7 +118,7 @@ static void __exit crct10dif_mod_fini(vo
 	crypto_unregister_shash(&alg);
 }
 
-async_module_init(crct10dif_mod_init);
+module_init(crct10dif_mod_init);
 module_exit(crct10dif_mod_fini);
 
 MODULE_AUTHOR("Tim Chen <tim.c.chen@linux.intel.com>");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/crypto_null.c linux-4.0.orig/crypto/crypto_null.c
--- linux-4.0/crypto/crypto_null.c	2015-04-20 21:09:49.922122608 +0100
+++ linux-4.0.orig/crypto/crypto_null.c	2015-04-12 23:12:50.000000000 +0100
@@ -175,7 +175,7 @@ static void __exit crypto_null_mod_fini(
 	crypto_unregister_algs(null_algs, ARRAY_SIZE(null_algs));
 }
 
-async_module_init(crypto_null_mod_init);
+module_init(crypto_null_mod_init);
 module_exit(crypto_null_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/crypto_user.c linux-4.0.orig/crypto/crypto_user.c
--- linux-4.0/crypto/crypto_user.c	2015-04-20 21:09:49.925122608 +0100
+++ linux-4.0.orig/crypto/crypto_user.c	2015-04-12 23:12:50.000000000 +0100
@@ -529,7 +529,7 @@ static void __exit crypto_user_exit(void
 	netlink_kernel_release(crypto_nlsk);
 }
 
-async_module_init(crypto_user_init);
+module_init(crypto_user_init);
 module_exit(crypto_user_exit);
 MODULE_LICENSE("GPL");
 MODULE_AUTHOR("Steffen Klassert <steffen.klassert@secunet.com>");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/ecb.c linux-4.0.orig/crypto/ecb.c
--- linux-4.0/crypto/ecb.c	2015-04-20 21:09:49.928122608 +0100
+++ linux-4.0.orig/crypto/ecb.c	2015-04-12 23:12:50.000000000 +0100
@@ -180,7 +180,7 @@ static void __exit crypto_ecb_module_exi
 	crypto_unregister_template(&crypto_ecb_tmpl);
 }
 
-async_module_init(crypto_ecb_module_init);
+module_init(crypto_ecb_module_init);
 module_exit(crypto_ecb_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/lrw.c linux-4.0.orig/crypto/lrw.c
--- linux-4.0/crypto/lrw.c	2015-04-20 21:09:49.930122608 +0100
+++ linux-4.0.orig/crypto/lrw.c	2015-04-12 23:12:50.000000000 +0100
@@ -395,7 +395,7 @@ static void __exit crypto_module_exit(vo
 	crypto_unregister_template(&crypto_tmpl);
 }
 
-async_module_init(crypto_module_init);
+module_init(crypto_module_init);
 module_exit(crypto_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/lz4.c linux-4.0.orig/crypto/lz4.c
--- linux-4.0/crypto/lz4.c	2015-04-20 21:09:49.933122609 +0100
+++ linux-4.0.orig/crypto/lz4.c	2015-04-12 23:12:50.000000000 +0100
@@ -99,7 +99,7 @@ static void __exit lz4_mod_fini(void)
 	crypto_unregister_alg(&alg_lz4);
 }
 
-async_module_init(lz4_mod_init);
+module_init(lz4_mod_init);
 module_exit(lz4_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/lz4hc.c linux-4.0.orig/crypto/lz4hc.c
--- linux-4.0/crypto/lz4hc.c	2015-04-20 21:09:49.935122609 +0100
+++ linux-4.0.orig/crypto/lz4hc.c	2015-04-12 23:12:50.000000000 +0100
@@ -99,7 +99,7 @@ static void __exit lz4hc_mod_fini(void)
 	crypto_unregister_alg(&alg_lz4hc);
 }
 
-async_module_init(lz4hc_mod_init);
+module_init(lz4hc_mod_init);
 module_exit(lz4hc_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/lzo.c linux-4.0.orig/crypto/lzo.c
--- linux-4.0/crypto/lzo.c	2015-04-20 21:09:49.937122609 +0100
+++ linux-4.0.orig/crypto/lzo.c	2015-04-12 23:12:50.000000000 +0100
@@ -102,7 +102,7 @@ static void __exit lzo_mod_fini(void)
 	crypto_unregister_alg(&alg);
 }
 
-async_module_init(lzo_mod_init);
+module_init(lzo_mod_init);
 module_exit(lzo_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/md4.c linux-4.0.orig/crypto/md4.c
--- linux-4.0/crypto/md4.c	2015-04-20 21:09:49.940122609 +0100
+++ linux-4.0.orig/crypto/md4.c	2015-04-12 23:12:50.000000000 +0100
@@ -250,7 +250,7 @@ static void __exit md4_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-async_module_init(md4_mod_init);
+module_init(md4_mod_init);
 module_exit(md4_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/md5.c linux-4.0.orig/crypto/md5.c
--- linux-4.0/crypto/md5.c	2015-04-20 21:09:49.944122609 +0100
+++ linux-4.0.orig/crypto/md5.c	2015-04-12 23:12:50.000000000 +0100
@@ -163,7 +163,7 @@ static void __exit md5_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-async_module_init(md5_mod_init);
+module_init(md5_mod_init);
 module_exit(md5_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/rmd128.c linux-4.0.orig/crypto/rmd128.c
--- linux-4.0/crypto/rmd128.c	2015-04-20 21:09:49.947122609 +0100
+++ linux-4.0.orig/crypto/rmd128.c	2015-04-12 23:12:50.000000000 +0100
@@ -321,7 +321,7 @@ static void __exit rmd128_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-async_module_init(rmd128_mod_init);
+module_init(rmd128_mod_init);
 module_exit(rmd128_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/rmd160.c linux-4.0.orig/crypto/rmd160.c
--- linux-4.0/crypto/rmd160.c	2015-04-20 21:09:49.957122609 +0100
+++ linux-4.0.orig/crypto/rmd160.c	2015-04-12 23:12:50.000000000 +0100
@@ -365,7 +365,7 @@ static void __exit rmd160_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-async_module_init(rmd160_mod_init);
+module_init(rmd160_mod_init);
 module_exit(rmd160_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/rmd256.c linux-4.0.orig/crypto/rmd256.c
--- linux-4.0/crypto/rmd256.c	2015-04-20 21:09:49.960122609 +0100
+++ linux-4.0.orig/crypto/rmd256.c	2015-04-12 23:12:50.000000000 +0100
@@ -340,7 +340,7 @@ static void __exit rmd256_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-async_module_init(rmd256_mod_init);
+module_init(rmd256_mod_init);
 module_exit(rmd256_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/rmd320.c linux-4.0.orig/crypto/rmd320.c
--- linux-4.0/crypto/rmd320.c	2015-04-20 21:09:49.963122609 +0100
+++ linux-4.0.orig/crypto/rmd320.c	2015-04-12 23:12:50.000000000 +0100
@@ -389,7 +389,7 @@ static void __exit rmd320_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-async_module_init(rmd320_mod_init);
+module_init(rmd320_mod_init);
 module_exit(rmd320_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/sha1_generic.c linux-4.0.orig/crypto/sha1_generic.c
--- linux-4.0/crypto/sha1_generic.c	2015-04-20 21:09:49.965122609 +0100
+++ linux-4.0.orig/crypto/sha1_generic.c	2015-04-12 23:12:50.000000000 +0100
@@ -147,7 +147,7 @@ static void __exit sha1_generic_mod_fini
 	crypto_unregister_shash(&alg);
 }
 
-async_module_init(sha1_generic_mod_init);
+module_init(sha1_generic_mod_init);
 module_exit(sha1_generic_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/sha256_generic.c linux-4.0.orig/crypto/sha256_generic.c
--- linux-4.0/crypto/sha256_generic.c	2015-04-20 21:09:49.969122609 +0100
+++ linux-4.0.orig/crypto/sha256_generic.c	2015-04-12 23:12:50.000000000 +0100
@@ -378,7 +378,7 @@ static void __exit sha256_generic_mod_fi
 	crypto_unregister_shashes(sha256_algs, ARRAY_SIZE(sha256_algs));
 }
 
-async_module_init(sha256_generic_mod_init);
+module_init(sha256_generic_mod_init);
 module_exit(sha256_generic_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/sha512_generic.c linux-4.0.orig/crypto/sha512_generic.c
--- linux-4.0/crypto/sha512_generic.c	2015-04-20 21:09:49.972122609 +0100
+++ linux-4.0.orig/crypto/sha512_generic.c	2015-04-12 23:12:50.000000000 +0100
@@ -282,7 +282,7 @@ static void __exit sha512_generic_mod_fi
 	crypto_unregister_shashes(sha512_algs, ARRAY_SIZE(sha512_algs));
 }
 
-async_module_init(sha512_generic_mod_init);
+module_init(sha512_generic_mod_init);
 module_exit(sha512_generic_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/tcrypt.c linux-4.0.orig/crypto/tcrypt.c
--- linux-4.0/crypto/tcrypt.c	2015-04-20 21:09:49.978122609 +0100
+++ linux-4.0.orig/crypto/tcrypt.c	2015-04-12 23:12:50.000000000 +0100
@@ -2188,7 +2188,7 @@ err_free_tv:
  */
 static void __exit tcrypt_mod_fini(void) { }
 
-async_module_init(tcrypt_mod_init);
+module_init(tcrypt_mod_init);
 module_exit(tcrypt_mod_fini);
 
 module_param(alg, charp, 0);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/tea.c linux-4.0.orig/crypto/tea.c
--- linux-4.0/crypto/tea.c	2015-04-20 21:09:49.981122609 +0100
+++ linux-4.0.orig/crypto/tea.c	2015-04-12 23:12:50.000000000 +0100
@@ -274,7 +274,7 @@ MODULE_ALIAS_CRYPTO("tea");
 MODULE_ALIAS_CRYPTO("xtea");
 MODULE_ALIAS_CRYPTO("xeta");
 
-async_module_init(tea_mod_init);
+module_init(tea_mod_init);
 module_exit(tea_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/tgr192.c linux-4.0.orig/crypto/tgr192.c
--- linux-4.0/crypto/tgr192.c	2015-04-20 21:09:49.984122609 +0100
+++ linux-4.0.orig/crypto/tgr192.c	2015-04-12 23:12:50.000000000 +0100
@@ -680,7 +680,7 @@ MODULE_ALIAS_CRYPTO("tgr192");
 MODULE_ALIAS_CRYPTO("tgr160");
 MODULE_ALIAS_CRYPTO("tgr128");
 
-async_module_init(tgr192_mod_init);
+module_init(tgr192_mod_init);
 module_exit(tgr192_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/twofish_generic.c linux-4.0.orig/crypto/twofish_generic.c
--- linux-4.0/crypto/twofish_generic.c	2015-04-20 21:09:49.986122609 +0100
+++ linux-4.0.orig/crypto/twofish_generic.c	2015-04-12 23:12:50.000000000 +0100
@@ -206,7 +206,7 @@ static void __exit twofish_mod_fini(void
 	crypto_unregister_alg(&alg);
 }
 
-async_module_init(twofish_mod_init);
+module_init(twofish_mod_init);
 module_exit(twofish_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/vmac.c linux-4.0.orig/crypto/vmac.c
--- linux-4.0/crypto/vmac.c	2015-04-20 21:09:49.989122609 +0100
+++ linux-4.0.orig/crypto/vmac.c	2015-04-12 23:12:50.000000000 +0100
@@ -708,7 +708,7 @@ static void __exit vmac_module_exit(void
 	crypto_unregister_template(&vmac_tmpl);
 }
 
-async_module_init(vmac_module_init);
+module_init(vmac_module_init);
 module_exit(vmac_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/wp512.c linux-4.0.orig/crypto/wp512.c
--- linux-4.0/crypto/wp512.c	2015-04-20 21:09:49.994122609 +0100
+++ linux-4.0.orig/crypto/wp512.c	2015-04-12 23:12:50.000000000 +0100
@@ -1171,7 +1171,7 @@ MODULE_ALIAS_CRYPTO("wp512");
 MODULE_ALIAS_CRYPTO("wp384");
 MODULE_ALIAS_CRYPTO("wp256");
 
-async_module_init(wp512_mod_init);
+module_init(wp512_mod_init);
 module_exit(wp512_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/xcbc.c linux-4.0.orig/crypto/xcbc.c
--- linux-4.0/crypto/xcbc.c	2015-04-20 21:09:49.996122609 +0100
+++ linux-4.0.orig/crypto/xcbc.c	2015-04-12 23:12:50.000000000 +0100
@@ -281,7 +281,7 @@ static void __exit crypto_xcbc_module_ex
 	crypto_unregister_template(&crypto_xcbc_tmpl);
 }
 
-async_module_init(crypto_xcbc_module_init);
+module_init(crypto_xcbc_module_init);
 module_exit(crypto_xcbc_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/xts.c linux-4.0.orig/crypto/xts.c
--- linux-4.0/crypto/xts.c	2015-04-20 21:09:49.998122609 +0100
+++ linux-4.0.orig/crypto/xts.c	2015-04-12 23:12:50.000000000 +0100
@@ -357,7 +357,7 @@ static void __exit crypto_module_exit(vo
 	crypto_unregister_template(&crypto_tmpl);
 }
 
-async_module_init(crypto_module_init);
+module_init(crypto_module_init);
 module_exit(crypto_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/crypto/zlib.c linux-4.0.orig/crypto/zlib.c
--- linux-4.0/crypto/zlib.c	2015-04-20 21:09:50.001122609 +0100
+++ linux-4.0.orig/crypto/zlib.c	2015-04-12 23:12:50.000000000 +0100
@@ -372,7 +372,7 @@ static void __exit zlib_mod_fini(void)
 	crypto_unregister_pcomp(&zlib_alg);
 }
 
-async_module_init(zlib_mod_init);
+module_init(zlib_mod_init);
 module_exit(zlib_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/acpi/ac.c linux-4.0.orig/drivers/acpi/ac.c
--- linux-4.0/drivers/acpi/ac.c	2015-04-20 21:09:50.016122610 +0100
+++ linux-4.0.orig/drivers/acpi/ac.c	2015-04-12 23:12:50.000000000 +0100
@@ -452,5 +452,5 @@ static void __exit acpi_ac_exit(void)
 	acpi_unlock_ac_dir(acpi_ac_dir);
 #endif
 }
-async_module_init(acpi_ac_init);
+module_init(acpi_ac_init);
 module_exit(acpi_ac_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/acpi/acpi_ipmi.c linux-4.0.orig/drivers/acpi/acpi_ipmi.c
--- linux-4.0/drivers/acpi/acpi_ipmi.c	2015-04-20 21:09:50.020122610 +0100
+++ linux-4.0.orig/drivers/acpi/acpi_ipmi.c	2015-04-12 23:12:50.000000000 +0100
@@ -657,5 +657,5 @@ static void __exit acpi_ipmi_exit(void)
 					  &acpi_ipmi_space_handler);
 }
 
-async_module_init(acpi_ipmi_init);
+module_init(acpi_ipmi_init);
 module_exit(acpi_ipmi_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/acpi/acpi_pad.c linux-4.0.orig/drivers/acpi/acpi_pad.c
--- linux-4.0/drivers/acpi/acpi_pad.c	2015-04-20 21:09:50.023122610 +0100
+++ linux-4.0.orig/drivers/acpi/acpi_pad.c	2015-04-12 23:12:50.000000000 +0100
@@ -514,7 +514,7 @@ static void __exit acpi_pad_exit(void)
 	acpi_bus_unregister_driver(&acpi_pad_driver);
 }
 
-async_module_init(acpi_pad_init);
+module_init(acpi_pad_init);
 module_exit(acpi_pad_exit);
 MODULE_AUTHOR("Shaohua Li<shaohua.li@intel.com>");
 MODULE_DESCRIPTION("ACPI Processor Aggregator Driver");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/acpi/battery.c linux-4.0.orig/drivers/acpi/battery.c
--- linux-4.0/drivers/acpi/battery.c	2015-04-20 21:09:50.027122610 +0100
+++ linux-4.0.orig/drivers/acpi/battery.c	2015-04-12 23:12:50.000000000 +0100
@@ -1319,5 +1319,5 @@ static void __exit acpi_battery_exit(voi
 #endif
 }
 
-async_module_init(acpi_battery_init);
+module_init(acpi_battery_init);
 module_exit(acpi_battery_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/acpi/processor_driver.c linux-4.0.orig/drivers/acpi/processor_driver.c
--- linux-4.0/drivers/acpi/processor_driver.c	2015-04-20 21:09:50.030122610 +0100
+++ linux-4.0.orig/drivers/acpi/processor_driver.c	2015-04-12 23:12:50.000000000 +0100
@@ -301,7 +301,7 @@ static void __exit acpi_processor_driver
 	driver_unregister(&acpi_processor_driver);
 }
 
-async_module_init(acpi_processor_driver_init);
+module_init(acpi_processor_driver_init);
 module_exit(acpi_processor_driver_exit);
 
 MODULE_ALIAS("processor");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/acpi/sbs.c linux-4.0.orig/drivers/acpi/sbs.c
--- linux-4.0/drivers/acpi/sbs.c	2015-04-20 21:09:50.034122610 +0100
+++ linux-4.0.orig/drivers/acpi/sbs.c	2015-04-12 23:12:50.000000000 +0100
@@ -755,5 +755,5 @@ static void __exit acpi_sbs_exit(void)
 	return;
 }
 
-async_module_init(acpi_sbs_init);
+module_init(acpi_sbs_init);
 module_exit(acpi_sbs_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/acpi/thermal.c linux-4.0.orig/drivers/acpi/thermal.c
--- linux-4.0/drivers/acpi/thermal.c	2015-04-20 21:09:50.038122610 +0100
+++ linux-4.0.orig/drivers/acpi/thermal.c	2015-04-12 23:12:50.000000000 +0100
@@ -1281,5 +1281,5 @@ static void __exit acpi_thermal_exit(voi
 	return;
 }
 
-async_module_init(acpi_thermal_init);
+module_init(acpi_thermal_init);
 module_exit(acpi_thermal_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/acpi/video.c linux-4.0.orig/drivers/acpi/video.c
--- linux-4.0/drivers/acpi/video.c	2015-04-20 21:09:50.070122610 +0100
+++ linux-4.0.orig/drivers/acpi/video.c	2015-04-12 23:12:50.000000000 +0100
@@ -2203,5 +2203,5 @@ static void __exit acpi_video_exit(void)
 	return;
 }
 
-async_module_init(acpi_video_init);
+module_init(acpi_video_init);
 module_exit(acpi_video_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/async.c linux-4.0.orig/drivers/async.c
--- linux-4.0/drivers/async.c	2015-04-20 21:00:20.555115875 +0100
+++ linux-4.0.orig/drivers/async.c	1970-01-01 01:00:00.000000000 +0100
@@ -1,370 +0,0 @@
-/*
- * dependency.c
- *
- * It implements a task scheduler with dependencies.
- * Every task can depends only from another one, not multiple dependencies is allowed
- *
- * A task has this members.
- * status - block by dependency, waiting to run
- * depends - the task that depends on
- *
- * When a task is complete all dependencies are unblocked, one of them is execute in the same thread
- * if there is no more dependencies to unblock then a waiting one is pick from the list.
- *
- * every running task is move to the end of the list
- * when list size reach zero then the running thread finish.
- *
- * if there is no any task to do then the thread must wait in a waiting queue until waiting task !=0
- * ones all task are done ( list size ==0) then waiting task get the value -1 to wakeup all waiting threads
- * and release all thread because list is empty.
- * spin lock have to be use to access the list
- *
- * any module which its dependency is not found on the list will take the highest
- *
- * Picking a new task.
- * Wake up all waiting task.
- * If number of waked up task != 1 the decrement and waiting += waked up
- * if (waiting) wake_up queue
- * if list empty return null
- * if waiting == 0 then pick one, waiting = len, signal queue
- *
- *	Main thread will start others threads and pick task from the list.
- *	if all task are waiting for end_idx then wait for all threads
- *
- *	List holding task
- *
- *  |----------------|----------|------------|
- *  begin            waiting    running      done/end
- *
- *  if waiting == running then all task became ready
- *
- *  two tables are in use
- *  1 . task data
- *  2 . task index -
- *
- *  Created on: 16 Apr 2015
- *      Author: lester.crespo
- */
-#include <linux/init.h>
-#include <linux/kernel.h>
-#include <linux/module.h>
-#include <linux/fs.h>
-#include <linux/uaccess.h>
-#include <linux/proc_fs.h>
-#include <linux/miscdevice.h>
-#include <linux/debugfs.h>
-#include <linux/mm.h>  // mmap related stuff
-#include <linux/slab.h>
-#include <linux/types.h>
-#include <linux/wait.h>
-#include <linux/sched.h>
-#include <linux/poll.h>
-#include <linux/types.h>
-//#include <linux/atomic.h>
-#include <asm/atomic.h>
-#include <linux/kthread.h>  // for threads
-
-#ifdef CONFIG_ASYNCHRO_MODULE_INIT_DEBUG
-#define printk_debug(...) printk(__VA_ARGS__)
-#else
-#define printk_debug(...) do {} while(0)
-#endif
-
-/**
- * Static struct holding all data
- */
-extern struct init_fn __async_initcall_start[], __async_initcall_end[];
-
-/**
- * at least one element has to be in the list in the position 0 that never executes
- */
-struct task_data
-{
-	struct init_fn* ptr;			// ptr to static task
-	struct init_fn* waiting_for;	// 0 ready,  1:end_idx waiting , > end_idx : lowest priority
-};
-
-/**
- * wait on the queue until unlocked != 0 then pick a task
- * locked == running; unlock all remaining task and scheduler
- *
- * main thread wait for unlocked !=0 or waiting == running
- * threads end when waiting == 0
- * last thread is when running became 0
- */
-#define MAX_TASKS 100
-struct depends_list
-{
-	unsigned waiting_last;	// last task waiting to be release
-	unsigned running_last;	// the last task running
-	unsigned end_idx;		// last element on the list
-	unsigned waiting;		// how many task are ready to be executed
-  struct init_fn* stask;  // static task structure
-	struct task_data task[MAX_TASKS];   //TODO use dinamic allocation
-};
-
-struct depends_list depends;
-static DEFINE_SPINLOCK(list_lock);
-static DECLARE_WAIT_QUEUE_HEAD(list_wait);
-
-/**
- * Mark task as done and get
- * Get a task from the list for execution
- * nullptr - no more task available
- */
-struct init_fn* TaskDone(struct init_fn* prev_task)
-{
-	unsigned i, j;
-	unsigned waiting;    // how many task has been wakeup
-	struct task_data task;
-	if (depends.running_last == 0)
-	  return 0;
-	//lock
-	spin_lock(&list_lock);
-	waiting = depends.waiting;    // detect how many task has been wake up
-	if (prev_task != 0)
-	{
-		for (i = depends.waiting_last; i < depends.running_last; ++i)
-		{
-			if (depends.task[i].ptr == prev_task)
-			{
-				// bring down a task to do
-				--depends.running_last;
-				depends.task[i] = depends.task[depends.running_last];
-				break;
-			}
-		}
-		// release all task that depends on the finished one and remember
-		for (i = 0; i < depends.waiting_last; ++i)
-		{
-			if (depends.task[i].waiting_for == prev_task)
-			{
-				depends.task[i].waiting_for = 0;
-				depends.waiting++;
-			}
-		}
-	}
-	// check if not running task and not pending one
-	if (depends.running_last == depends.waiting_last && depends.waiting == 0)
-	{
-		// the unlock all task, maybe is better execute one by one task that we do not known what it depends on
-		for (i = 0; i < depends.waiting_last; ++i)
-		{
-			depends.task[i].waiting_for = 0;
-			depends.waiting++;
-		}
-	}
-	// pick a new task
-	if (depends.waiting != 0)
-	{
-		// find the lower id task available
-		prev_task = depends.stask + depends.end_idx;
-		j = 0;
-		for (i = 0; i < depends.waiting_last; ++i)
-		{
-			if (depends.task[i].waiting_for == 0 && depends.task[i].ptr < prev_task)
-			{
-				prev_task = depends.task[i].ptr;
-				j = i;
-			}
-		}
-		--depends.waiting;
-		--depends.waiting_last;
-		task = depends.task[j];
-		depends.task[j] = depends.task[depends.waiting_last];
-		depends.task[depends.waiting_last] = task;
-	} else
-	{
-		// check end of all task
-		if (depends.running_last == 0)
-		{
-			// clean up all memory
-		}
-		prev_task = 0;
-	}
-	// spin unlock
-	spin_unlock(&list_lock);
-	// allow other thread pick a task
-	if ((depends.waiting > waiting + 1 ) || (depends.running_last == 0))
-	  wake_up_interruptible(&list_wait);
-	if ((prev_task == 0) && (depends.running_last == 0))
-	{
-	  free_initmem();
-	}
-	return prev_task;
-}
-
-void Prepare(struct init_fn* begin, struct init_fn* end,task_type_t type)
-{
-	// fill dependencies structure
-	struct init_fn* it_task;
-	unsigned i;
-	depends.waiting = 0;
-	depends.end_idx = 0;
-	for (it_task = begin; it_task < end; ++it_task)
-	{
-		if (it_task->type_ == type)
-		{
-			depends.task[depends.end_idx].ptr = it_task;
-			depends.task[depends.end_idx].waiting_for = 0;
-			++depends.end_idx;
-		}
-	}
-	depends.waiting_last = depends.end_idx;
-	depends.running_last = depends.end_idx;
-	// resolve dependencies
-	for (i = 0; i < depends.end_idx; ++i)
-	{
-		if ((depends.task[i].ptr->depends_on != 0) && (*depends.task[i].ptr->depends_on != 0))
-		{
-			for (it_task = begin; it_task < end; ++it_task)
-			{
-				if (strcmp(it_task->name, depends.task[i].ptr->depends_on) == 0)
-				{
-					if (it_task->type_ != type)
-					{
-						printk("async cross type dependency detected %s -> %s",depends.task[i].ptr->name,it_task->name);
-						it_task = end;
-					}
-					break;
-				}
-			}	
-			depends.task[i].waiting_for = it_task;    // it will point to the end if task not found
-			printk_debug("async registered '%s' --> '%s'\n", depends.task[i].ptr->name,(it_task != end) ? it_task->name : "not found");
-		} else
-		{
-			depends.waiting++;			// avoid bug,
-			printk_debug("async registered '%s'\n", depends.task[i].ptr->name);
-		}
-	}
-}
-
-int WorkingThread(void *data)
-{
-  int ret;
-  //struct task_struct *kthread = *(struct task_struct**)data;
-	struct init_fn* task = 0;
-	printk_debug("async %d starts\n",(unsigned)data);
-	do
-	{
-		task = TaskDone(task);
-		if (task != 0)
-		{
-		  printk_debug("async start %d %s\n",(unsigned)data, task->name);
-		  do_one_initcall(task->fnc);
-		} else
-		{
-		  printk_debug("async %d waiting ...\n",(unsigned)data);
-		  ret = wait_event_interruptible(list_wait, (depends.waiting !=0 || depends.waiting_last == 0));
-		  if (ret != 0)
-		  {
-		    printk("async init wake up returned %d\n",ret);
-		    break;
-		  }
-			//wait for (depends.unlocked !=0 or depends.waiting_last == 0)
-		}
-	} while (depends.waiting_last != 0);	// something to do
-	printk_debug("async %d ends\n",(unsigned)data);
-	return 0;
-}
-
-/**
- * Execute all initialization for an specific type
- */
- int doit_type(task_type_t type)
- {
- 	unsigned max_threads = CONFIG_ASYNCHRO_MODULE_INIT_THREADS;
-  unsigned max_cpus = num_online_cpus();
-  static struct task_struct *thr;
- 	Prepare(__async_initcall_start, __async_initcall_end,type);
- 	for (; max_threads != 0; --max_threads)
-  {
-    //start working threads
-    thr = kthread_create(WorkingThread,(void*)( max_threads), "async thread");
-    if (thr != ERR_PTR(-ENOMEM))
-    {
-      kthread_bind(thr, max_threads % max_cpus);
-      wake_up_process(thr);
-    } else
-    {
-      printk("Async module initialization thread failed .. fall back to normal mode");
-      //WorkingThread(NULL);
-    }
-  }
- 	return 0;
- }
-/**
- * First initialization of module. Disk diver and AGP  
-*/
-static int async_initialization(void)
-{
-		return doit_type(asynchronized);
-}
-/**
- * Second initialization USB devices, some PCI
- */ 
-static int deferred_initialization(void)
-{
- 	return doit_type(deferred);
-}
-
-module_init(async_initialization);
-late_initcall_sync(deferred_initialization);		// Second stage, last to do before jump to high level initialization
-
-#ifdef TEST
-#define DOIT(x) do { printf("...\n"); Prepare(x,sizeof(x)/sizeof(*x)); WorkingThread(); } while(0)
-
-int main()
-{
-	// single
-	struct s_task list1[] =
-	{
-		{	"a", 0},
-		{	"b", "a"},
-		{	"c", "b"},
-		{	"d", "b"}};
-	// keep order for single thread but can be all together
-	struct s_task list2[] =
-	{
-		{	"a", 0},
-		{	"b",0},
-		{	"c", 0},
-		{	"d", 0}};
-	// order is keep because dependences are resolved on time
-	struct s_task list3[] =
-	{
-		{	"a",0},
-		{	"b","a"},
-		{	"c","b"},
-		{	"d",0},
-		{	"e", 0}};
-
-	struct s_task list4[] =
-	{
-		{	"a",0},
-		{	"d","c"},
-		{	"e",0},
-		{	"b","a"},
-		{	"c","b"}
-
-	};
-
-	//
-	struct s_task list5[] =
-	{
-		{	"a", 0}};
-
-	DOIT(list1);
-	DOIT(list2);
-	DOIT(list3);
-	DOIT(list4);
-//	Prepare(list1,sizeof(list1)/sizeof(*list1));
-//	WorkingThread();
-//	Prepare(list2,sizeof(list2)/sizeof(*list2));
-//	WorkingThread();
-//	Prepare(list3,sizeof(list3)/sizeof(*list));
-//	WorkingThread();
-
-}
-#endif
-
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/ata/acard-ahci.c linux-4.0.orig/drivers/ata/acard-ahci.c
--- linux-4.0/drivers/ata/acard-ahci.c	2015-04-19 23:13:29.272001581 +0100
+++ linux-4.0.orig/drivers/ata/acard-ahci.c	2015-04-12 23:12:50.000000000 +0100
@@ -501,7 +501,7 @@ static int acard_ahci_init_one(struct pc
 	return ahci_host_activate(host, pdev->irq, &acard_ahci_sht);
 }
 
-async_module_pci_driver(acard_ahci_pci_driver);
+module_pci_driver(acard_ahci_pci_driver);
 
 MODULE_AUTHOR("Jeff Garzik");
 MODULE_DESCRIPTION("ACard AHCI SATA low-level driver");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/ata/ahci.c linux-4.0.orig/drivers/ata/ahci.c
--- linux-4.0/drivers/ata/ahci.c	2015-04-19 23:24:31.701009415 +0100
+++ linux-4.0.orig/drivers/ata/ahci.c	2015-04-12 23:12:50.000000000 +0100
@@ -1465,7 +1465,7 @@ static int ahci_init_one(struct pci_dev
 	return ahci_host_activate(host, pdev->irq, &ahci_sht);
 }
 
-async_module_pci_driver(ahci_pci_driver);
+module_pci_driver(ahci_pci_driver);
 
 MODULE_AUTHOR("Jeff Garzik");
 MODULE_DESCRIPTION("AHCI SATA low-level driver");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/char/agp/backend.c linux-4.0.orig/drivers/char/agp/backend.c
--- linux-4.0/drivers/char/agp/backend.c	2015-04-19 23:42:07.686021902 +0100
+++ linux-4.0.orig/drivers/char/agp/backend.c	2015-04-12 23:12:50.000000000 +0100
@@ -361,6 +361,6 @@ MODULE_DESCRIPTION("AGP GART driver");
 MODULE_LICENSE("GPL and additional rights");
 MODULE_ALIAS_MISCDEV(AGPGART_MINOR);
 
-async_module_init(agp_init);
+module_init(agp_init);
 module_exit(agp_exit);
 
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/char/agp/nvidia-agp.c linux-4.0.orig/drivers/char/agp/nvidia-agp.c
--- linux-4.0/drivers/char/agp/nvidia-agp.c	2015-04-20 21:09:50.073122610 +0100
+++ linux-4.0.orig/drivers/char/agp/nvidia-agp.c	2015-04-12 23:12:50.000000000 +0100
@@ -468,7 +468,7 @@ static void __exit agp_nvidia_cleanup(vo
 	pci_dev_put(nvidia_private.dev_3);
 }
 
-async_module_init(agp_nvidia_init,agp_init);
+module_init(agp_nvidia_init);
 module_exit(agp_nvidia_cleanup);
 
 MODULE_LICENSE("GPL and additional rights");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/char/hpet.c linux-4.0.orig/drivers/char/hpet.c
--- linux-4.0/drivers/char/hpet.c	2015-04-20 21:09:50.077122610 +0100
+++ linux-4.0.orig/drivers/char/hpet.c	2015-04-12 23:12:50.000000000 +0100
@@ -1098,7 +1098,7 @@ static void __exit hpet_exit(void)
 	return;
 }
 
-async_module_init(hpet_init);
+module_init(hpet_init);
 module_exit(hpet_exit);
 MODULE_AUTHOR("Bob Picco <Robert.Picco@hp.com>");
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/cpufreq/cpufreq_conservative.c linux-4.0.orig/drivers/cpufreq/cpufreq_conservative.c
--- linux-4.0/drivers/cpufreq/cpufreq_conservative.c	2015-04-19 21:38:49.773934419 +0100
+++ linux-4.0.orig/drivers/cpufreq/cpufreq_conservative.c	2015-04-12 23:12:50.000000000 +0100
@@ -403,6 +403,6 @@ MODULE_LICENSE("GPL");
 #ifdef CONFIG_CPU_FREQ_DEFAULT_GOV_CONSERVATIVE
 fs_initcall(cpufreq_gov_dbs_init);
 #else
-async_module_init(cpufreq_gov_dbs_init);
+module_init(cpufreq_gov_dbs_init);
 #endif
 module_exit(cpufreq_gov_dbs_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/cpufreq/cpufreq_ondemand.c linux-4.0.orig/drivers/cpufreq/cpufreq_ondemand.c
--- linux-4.0/drivers/cpufreq/cpufreq_ondemand.c	2015-04-19 21:38:49.714934419 +0100
+++ linux-4.0.orig/drivers/cpufreq/cpufreq_ondemand.c	2015-04-12 23:12:50.000000000 +0100
@@ -626,6 +626,6 @@ MODULE_LICENSE("GPL");
 #ifdef CONFIG_CPU_FREQ_DEFAULT_GOV_ONDEMAND
 fs_initcall(cpufreq_gov_dbs_init);
 #else
-async_module_init(cpufreq_gov_dbs_init);
+module_init(cpufreq_gov_dbs_init);
 #endif
 module_exit(cpufreq_gov_dbs_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/cpufreq/cpufreq_powersave.c linux-4.0.orig/drivers/cpufreq/cpufreq_powersave.c
--- linux-4.0/drivers/cpufreq/cpufreq_powersave.c	2015-04-19 21:38:49.689934418 +0100
+++ linux-4.0.orig/drivers/cpufreq/cpufreq_powersave.c	2015-04-12 23:12:50.000000000 +0100
@@ -59,6 +59,6 @@ MODULE_LICENSE("GPL");
 #ifdef CONFIG_CPU_FREQ_DEFAULT_GOV_POWERSAVE
 fs_initcall(cpufreq_gov_powersave_init);
 #else
-async_module_init(cpufreq_gov_powersave_init);
+module_init(cpufreq_gov_powersave_init);
 #endif
 module_exit(cpufreq_gov_powersave_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/cpufreq/cpufreq_stats.c linux-4.0.orig/drivers/cpufreq/cpufreq_stats.c
--- linux-4.0/drivers/cpufreq/cpufreq_stats.c	2015-04-19 21:38:49.685934418 +0100
+++ linux-4.0.orig/drivers/cpufreq/cpufreq_stats.c	2015-04-12 23:12:50.000000000 +0100
@@ -353,5 +353,5 @@ MODULE_AUTHOR("Zou Nan hai <nanhai.zou@i
 MODULE_DESCRIPTION("Export cpufreq stats via sysfs");
 MODULE_LICENSE("GPL");
 
-async_module_init(cpufreq_stats_init);
+module_init(cpufreq_stats_init);
 module_exit(cpufreq_stats_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/cpufreq/cpufreq_userspace.c linux-4.0.orig/drivers/cpufreq/cpufreq_userspace.c
--- linux-4.0/drivers/cpufreq/cpufreq_userspace.c	2015-04-19 21:38:49.680934418 +0100
+++ linux-4.0.orig/drivers/cpufreq/cpufreq_userspace.c	2015-04-12 23:12:50.000000000 +0100
@@ -118,6 +118,6 @@ MODULE_LICENSE("GPL");
 #ifdef CONFIG_CPU_FREQ_DEFAULT_GOV_USERSPACE
 fs_initcall(cpufreq_gov_userspace_init);
 #else
-async_module_init(cpufreq_gov_userspace_init);
+module_init(cpufreq_gov_userspace_init);
 #endif
 module_exit(cpufreq_gov_userspace_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/gpu/drm/Kconfig linux-4.0.orig/drivers/gpu/drm/Kconfig
--- linux-4.0/drivers/gpu/drm/Kconfig	2015-04-13 23:52:11.415705252 +0100
+++ linux-4.0.orig/drivers/gpu/drm/Kconfig	2015-04-12 23:12:50.000000000 +0100
@@ -77,13 +77,10 @@ config DRM_KMS_CMA_HELPER
 	help
 	  Choose this if you need the KMS CMA helper functions
 
-
 source "drivers/gpu/drm/i2c/Kconfig"
 
 source "drivers/gpu/drm/bridge/Kconfig"
 
-source "drivers/gpu/drm/nvidia-ion/Kconfig"
-
 config DRM_TDFX
 	tristate "3dfx Banshee/Voodoo3+"
 	depends on DRM && PCI
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/gpu/drm/Makefile linux-4.0.orig/drivers/gpu/drm/Makefile
--- linux-4.0/drivers/gpu/drm/Makefile	2015-04-13 23:49:11.367703122 +0100
+++ linux-4.0.orig/drivers/gpu/drm/Makefile	2015-04-12 23:12:50.000000000 +0100
@@ -34,7 +34,6 @@ CFLAGS_drm_trace_points.o := -I$(src)
 
 obj-$(CONFIG_DRM)	+= drm.o
 obj-$(CONFIG_DRM_MIPI_DSI) += drm_mipi_dsi.o
-obj-$(CONFIG_NVIDIA_ION)	+= nvidia-ion/
 obj-$(CONFIG_DRM_TTM)	+= ttm/
 obj-$(CONFIG_DRM_TDFX)	+= tdfx/
 obj-$(CONFIG_DRM_R128)	+= r128/
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/hid/hid-core.c linux-4.0.orig/drivers/hid/hid-core.c
--- linux-4.0/drivers/hid/hid-core.c	2015-04-19 21:42:25.694936973 +0100
+++ linux-4.0.orig/drivers/hid/hid-core.c	2015-04-12 23:12:50.000000000 +0100
@@ -2734,7 +2734,7 @@ static void __exit hid_exit(void)
 	bus_unregister(&hid_bus_type);
 }
 
-async_module_init(hid_init);
+module_init(hid_init);
 module_exit(hid_exit);
 
 MODULE_AUTHOR("Andreas Gal");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/hid/hid-elo.c linux-4.0.orig/drivers/hid/hid-elo.c
--- linux-4.0/drivers/hid/hid-elo.c	2015-04-19 21:42:25.672936972 +0100
+++ linux-4.0.orig/drivers/hid/hid-elo.c	2015-04-12 23:12:50.000000000 +0100
@@ -293,7 +293,7 @@ static int __init elo_driver_init(void)
 
 	return ret;
 }
-async_module_init(elo_driver_init);
+module_init(elo_driver_init);
 
 static void __exit elo_driver_exit(void)
 {
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/hid/uhid.c linux-4.0.orig/drivers/hid/uhid.c
--- linux-4.0/drivers/hid/uhid.c	2015-04-19 21:42:19.880936904 +0100
+++ linux-4.0.orig/drivers/hid/uhid.c	2015-04-12 23:12:50.000000000 +0100
@@ -775,7 +775,7 @@ static void __exit uhid_exit(void)
 	misc_deregister(&uhid_misc);
 }
 
-async_module_init(uhid_init);
+module_init(uhid_init);
 module_exit(uhid_exit);
 MODULE_LICENSE("GPL");
 MODULE_AUTHOR("David Herrmann <dh.herrmann@gmail.com>");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/hid/usbhid/hid-core.c linux-4.0.orig/drivers/hid/usbhid/hid-core.c
--- linux-4.0/drivers/hid/usbhid/hid-core.c	2015-04-19 21:41:52.587936581 +0100
+++ linux-4.0.orig/drivers/hid/usbhid/hid-core.c	2015-04-12 23:12:50.000000000 +0100
@@ -1651,7 +1651,7 @@ static void __exit hid_exit(void)
 	usbhid_quirks_exit();
 }
 
-async_module_init(hid_init);
+module_init(hid_init);
 module_exit(hid_exit);
 
 MODULE_AUTHOR("Andreas Gal");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/input/keyboard/atkbd.c linux-4.0.orig/drivers/input/keyboard/atkbd.c
--- linux-4.0/drivers/input/keyboard/atkbd.c	2015-04-20 21:09:50.136122611 +0100
+++ linux-4.0.orig/drivers/input/keyboard/atkbd.c	2015-04-12 23:12:50.000000000 +0100
@@ -1811,5 +1811,5 @@ static void __exit atkbd_exit(void)
 	serio_unregister_driver(&atkbd_drv);
 }
 
-async_module_init(atkbd_init);
+module_init(atkbd_init);
 module_exit(atkbd_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/input/misc/uinput.c linux-4.0.orig/drivers/input/misc/uinput.c
--- linux-4.0/drivers/input/misc/uinput.c	2015-04-20 21:09:50.139122611 +0100
+++ linux-4.0.orig/drivers/input/misc/uinput.c	2015-04-12 23:12:50.000000000 +0100
@@ -939,5 +939,5 @@ MODULE_DESCRIPTION("User level driver su
 MODULE_LICENSE("GPL");
 MODULE_VERSION("0.3");
 
-async_module_init(uinput_init);
+module_init(uinput_init);
 module_exit(uinput_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/input/mouse/psmouse-base.c linux-4.0.orig/drivers/input/mouse/psmouse-base.c
--- linux-4.0/drivers/input/mouse/psmouse-base.c	2015-04-20 21:09:50.143122611 +0100
+++ linux-4.0.orig/drivers/input/mouse/psmouse-base.c	2015-04-12 23:12:50.000000000 +0100
@@ -1894,5 +1894,5 @@ static void __exit psmouse_exit(void)
 	destroy_workqueue(kpsmoused_wq);
 }
 
-async_module_init(psmouse_init);
+module_init(psmouse_init);
 module_exit(psmouse_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/input/mousedev.c linux-4.0.orig/drivers/input/mousedev.c
--- linux-4.0/drivers/input/mousedev.c	2015-04-20 21:09:50.146122611 +0100
+++ linux-4.0.orig/drivers/input/mousedev.c	2015-04-12 23:12:50.000000000 +0100
@@ -1124,5 +1124,5 @@ static void __exit mousedev_exit(void)
 	mousedev_destroy(mousedev_mix);
 }
 
-async_module_init(mousedev_init);
+module_init(mousedev_init);
 module_exit(mousedev_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/input/serio/i8042.c linux-4.0.orig/drivers/input/serio/i8042.c
--- linux-4.0/drivers/input/serio/i8042.c	2015-04-20 21:09:50.150122611 +0100
+++ linux-4.0.orig/drivers/input/serio/i8042.c	2015-04-12 23:12:50.000000000 +0100
@@ -1524,5 +1524,5 @@ static void __exit i8042_exit(void)
 	panic_blink = NULL;
 }
 
-async_module_init(i8042_init);
+module_init(i8042_init);
 module_exit(i8042_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/input/serio/serport.c linux-4.0.orig/drivers/input/serio/serport.c
--- linux-4.0/drivers/input/serio/serport.c	2015-04-20 21:09:50.152122611 +0100
+++ linux-4.0.orig/drivers/input/serio/serport.c	2015-04-12 23:12:50.000000000 +0100
@@ -297,5 +297,5 @@ static void __exit serport_exit(void)
 	tty_unregister_ldisc(N_MOUSE);
 }
 
-async_module_init(serport_init);
+module_init(serport_init);
 module_exit(serport_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/Kconfig linux-4.0.orig/drivers/Kconfig
--- linux-4.0/drivers/Kconfig	2015-04-19 21:49:50.175942229 +0100
+++ linux-4.0.orig/drivers/Kconfig	2015-04-12 23:12:50.000000000 +0100
@@ -1,20 +1,5 @@
 menu "Device Drivers"
 
-config ASYNCHRO_MODULE_INIT
-	bool "Initialize module in Asynchronize way using single module dependencies"
-	---help---
-	Asynchrone drivers initialization routine 
-	
-if ASYNCHRO_MODULE_INIT
-	config ASYNCHRO_MODULE_INIT_DEBUG
-	bool "Debug mode"
-	
-	config ASYNCHRO_MODULE_INIT_THREADS	
-	int "Maximum number of threads"
-	range 1 4
-	default "2" 
-endif
-	
 source "drivers/amba/Kconfig"
 
 source "drivers/base/Kconfig"
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/Makefile linux-4.0.orig/drivers/Makefile
--- linux-4.0/drivers/Makefile	2015-04-19 16:33:49.593718013 +0100
+++ linux-4.0.orig/drivers/Makefile	2015-04-12 23:12:50.000000000 +0100
@@ -33,9 +33,6 @@ obj-y				+= amba/
 # really early.
 obj-$(CONFIG_DMADEVICES)	+= dma/
 
-#ready for asyncronized initialization
-obj-y += async.o
-
 # SOC specific infrastructure drivers.
 obj-y				+= soc/
 
@@ -168,5 +165,3 @@ obj-$(CONFIG_RAS)		+= ras/
 obj-$(CONFIG_THUNDERBOLT)	+= thunderbolt/
 obj-$(CONFIG_CORESIGHT)		+= coresight/
 obj-$(CONFIG_ANDROID)		+= android/
-
-
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/net/wireless/b43/main.c linux-4.0.orig/drivers/net/wireless/b43/main.c
--- linux-4.0/drivers/net/wireless/b43/main.c	2015-04-20 21:09:50.162122611 +0100
+++ linux-4.0.orig/drivers/net/wireless/b43/main.c	2015-04-12 23:12:50.000000000 +0100
@@ -5897,5 +5897,5 @@ static void __exit b43_exit(void)
 	b43_debugfs_exit();
 }
 
-async_module_init(b43_init)
+module_init(b43_init)
 module_exit(b43_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/net/wireless/b43legacy/main.c linux-4.0.orig/drivers/net/wireless/b43legacy/main.c
--- linux-4.0/drivers/net/wireless/b43legacy/main.c	2015-04-20 21:09:50.209122612 +0100
+++ linux-4.0.orig/drivers/net/wireless/b43legacy/main.c	2015-04-12 23:12:50.000000000 +0100
@@ -4061,5 +4061,5 @@ static void __exit b43legacy_exit(void)
 	b43legacy_debugfs_exit();
 }
 
-async_module_init(b43legacy_init)
+module_init(b43legacy_init)
 module_exit(b43legacy_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/net/wireless/ipw2x00/ipw2100.c linux-4.0.orig/drivers/net/wireless/ipw2x00/ipw2100.c
--- linux-4.0/drivers/net/wireless/ipw2x00/ipw2100.c	2015-04-20 21:09:50.222122612 +0100
+++ linux-4.0.orig/drivers/net/wireless/ipw2x00/ipw2100.c	2015-04-12 23:12:50.000000000 +0100
@@ -6611,7 +6611,7 @@ static void __exit ipw2100_exit(void)
 	pm_qos_remove_request(&ipw2100_pm_qos_req);
 }
 
-async_module_init(ipw2100_init);
+module_init(ipw2100_init);
 module_exit(ipw2100_exit);
 
 static int ipw2100_wx_get_name(struct net_device *dev,
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/pci/hotplug/pciehp_core.c linux-4.0.orig/drivers/pci/hotplug/pciehp_core.c
--- linux-4.0/drivers/pci/hotplug/pciehp_core.c	2015-04-20 21:09:50.227122612 +0100
+++ linux-4.0.orig/drivers/pci/hotplug/pciehp_core.c	2015-04-12 23:12:50.000000000 +0100
@@ -383,5 +383,5 @@ static void __exit pcied_cleanup(void)
 	info(DRIVER_DESC " version: " DRIVER_VERSION " unloaded\n");
 }
 
-async_module_init(pcied_init,pci_hotplug_init);
+module_init(pcied_init);
 module_exit(pcied_cleanup);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/pci/hotplug/pci_hotplug_core.c linux-4.0.orig/drivers/pci/hotplug/pci_hotplug_core.c
--- linux-4.0/drivers/pci/hotplug/pci_hotplug_core.c	2015-04-20 21:09:50.225122612 +0100
+++ linux-4.0.orig/drivers/pci/hotplug/pci_hotplug_core.c	2015-04-12 23:12:50.000000000 +0100
@@ -545,7 +545,7 @@ static void __exit pci_hotplug_exit(void
 	cpci_hotplug_exit();
 }
 
-async_module_init(pci_hotplug_init,pcie_portdrv_init);
+module_init(pci_hotplug_init);
 module_exit(pci_hotplug_exit);
 
 MODULE_AUTHOR(DRIVER_AUTHOR);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/pci/hotplug/shpchp_core.c linux-4.0.orig/drivers/pci/hotplug/shpchp_core.c
--- linux-4.0/drivers/pci/hotplug/shpchp_core.c	2015-04-20 21:09:50.230122612 +0100
+++ linux-4.0.orig/drivers/pci/hotplug/shpchp_core.c	2015-04-12 23:12:50.000000000 +0100
@@ -385,5 +385,5 @@ static void __exit shpcd_cleanup(void)
 	info(DRIVER_DESC " version: " DRIVER_VERSION " unloaded\n");
 }
 
-async_module_init(shpcd_init,pcied_init);
+module_init(shpcd_init);
 module_exit(shpcd_cleanup);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/pci/pcie/portdrv_pci.c linux-4.0.orig/drivers/pci/pcie/portdrv_pci.c
--- linux-4.0/drivers/pci/pcie/portdrv_pci.c	2015-04-20 21:09:50.232122612 +0100
+++ linux-4.0.orig/drivers/pci/pcie/portdrv_pci.c	2015-04-12 23:12:50.000000000 +0100
@@ -361,4 +361,4 @@ static int __init pcie_portdrv_init(void
 	return retval;
 }
 
-async_module_init(pcie_portdrv_init);
+module_init(pcie_portdrv_init);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/usb/host/ehci-hcd.c linux-4.0.orig/drivers/usb/host/ehci-hcd.c
--- linux-4.0/drivers/usb/host/ehci-hcd.c	2015-04-20 21:09:50.244122612 +0100
+++ linux-4.0.orig/drivers/usb/host/ehci-hcd.c	2015-04-12 23:12:50.000000000 +0100
@@ -1376,7 +1376,7 @@ err_debug:
 	clear_bit(USB_EHCI_LOADED, &usb_hcds_loaded);
 	return retval;
 }
-async_module_init(ehci_hcd_init);
+module_init(ehci_hcd_init);
 
 static void __exit ehci_hcd_cleanup(void)
 {
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/usb/host/ehci-pci.c linux-4.0.orig/drivers/usb/host/ehci-pci.c
--- linux-4.0/drivers/usb/host/ehci-pci.c	2015-04-20 21:09:50.247122612 +0100
+++ linux-4.0.orig/drivers/usb/host/ehci-pci.c	2015-04-12 23:12:50.000000000 +0100
@@ -421,7 +421,7 @@ static int __init ehci_pci_init(void)
 
 	return pci_register_driver(&ehci_pci_driver);
 }
-async_module_init(ehci_pci_init,ehci_hcd_init);
+module_init(ehci_pci_init);
 
 static void __exit ehci_pci_cleanup(void)
 {
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/usb/host/ehci-platform.c linux-4.0.orig/drivers/usb/host/ehci-platform.c
--- linux-4.0/drivers/usb/host/ehci-platform.c	2015-04-20 21:09:50.250122612 +0100
+++ linux-4.0.orig/drivers/usb/host/ehci-platform.c	2015-04-12 23:12:50.000000000 +0100
@@ -428,7 +428,7 @@ static int __init ehci_platform_init(voi
 	ehci_init_driver(&ehci_platform_hc_driver, &platform_overrides);
 	return platform_driver_register(&ehci_platform_driver);
 }
-async_module_init(ehci_platform_init,ehci_hcd_init);
+module_init(ehci_platform_init);
 
 static void __exit ehci_platform_cleanup(void)
 {
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/usb/host/ohci-hcd.c linux-4.0.orig/drivers/usb/host/ohci-hcd.c
--- linux-4.0/drivers/usb/host/ohci-hcd.c	2015-04-20 21:09:50.255122612 +0100
+++ linux-4.0.orig/drivers/usb/host/ohci-hcd.c	2015-04-12 23:12:50.000000000 +0100
@@ -1352,7 +1352,7 @@ static int __init ohci_hcd_mod_init(void
 	clear_bit(USB_OHCI_LOADED, &usb_hcds_loaded);
 	return retval;
 }
-async_module_init(ohci_hcd_mod_init,ehci_platform_init);
+module_init(ohci_hcd_mod_init);
 
 static void __exit ohci_hcd_mod_exit(void)
 {
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/usb/host/ohci-pci.c linux-4.0.orig/drivers/usb/host/ohci-pci.c
--- linux-4.0/drivers/usb/host/ohci-pci.c	2015-04-20 21:09:50.258122612 +0100
+++ linux-4.0.orig/drivers/usb/host/ohci-pci.c	2015-04-12 23:12:50.000000000 +0100
@@ -302,7 +302,7 @@ static int __init ohci_pci_init(void)
 
 	return pci_register_driver(&ohci_pci_driver);
 }
-async_module_init(ohci_pci_init,ohci_hcd_mod_init);
+module_init(ohci_pci_init);
 
 static void __exit ohci_pci_cleanup(void)
 {
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/usb/host/ohci-platform.c linux-4.0.orig/drivers/usb/host/ohci-platform.c
--- linux-4.0/drivers/usb/host/ohci-platform.c	2015-04-20 21:09:50.260122612 +0100
+++ linux-4.0.orig/drivers/usb/host/ohci-platform.c	2015-04-12 23:12:50.000000000 +0100
@@ -402,7 +402,7 @@ static int __init ohci_platform_init(voi
 	ohci_init_driver(&ohci_platform_hc_driver, &platform_overrides);
 	return platform_driver_register(&ohci_platform_driver);
 }
-async_module_init(ohci_platform_init,ohci_hcd_mod_init);
+module_init(ohci_platform_init);
 
 static void __exit ohci_platform_cleanup(void)
 {
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/usb/host/ssb-hcd.c linux-4.0.orig/drivers/usb/host/ssb-hcd.c
--- linux-4.0/drivers/usb/host/ssb-hcd.c	2015-04-20 21:09:50.263122612 +0100
+++ linux-4.0.orig/drivers/usb/host/ssb-hcd.c	2015-04-12 23:12:50.000000000 +0100
@@ -269,7 +269,7 @@ static int __init ssb_hcd_init(void)
 {
 	return ssb_driver_register(&ssb_hcd_driver);
 }
-async_module_init(ssb_hcd_init);
+module_init(ssb_hcd_init);
 
 static void __exit ssb_hcd_exit(void)
 {
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/drivers/usb/host/uhci-hcd.c linux-4.0.orig/drivers/usb/host/uhci-hcd.c
--- linux-4.0/drivers/usb/host/uhci-hcd.c	2015-04-20 21:09:50.268122612 +0100
+++ linux-4.0.orig/drivers/usb/host/uhci-hcd.c	2015-04-12 23:12:50.000000000 +0100
@@ -937,7 +937,7 @@ static void __exit uhci_hcd_cleanup(void
 	clear_bit(USB_UHCI_LOADED, &usb_hcds_loaded);
 }
 
-async_module_init(uhci_hcd_init);
+module_init(uhci_hcd_init);
 module_exit(uhci_hcd_cleanup);
 
 MODULE_AUTHOR(DRIVER_AUTHOR);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/fs/cifs/cifsfs.c linux-4.0.orig/fs/cifs/cifsfs.c
--- linux-4.0/fs/cifs/cifsfs.c	2015-04-20 21:09:50.271122613 +0100
+++ linux-4.0.orig/fs/cifs/cifsfs.c	2015-04-12 23:12:50.000000000 +0100
@@ -1314,5 +1314,5 @@ MODULE_DESCRIPTION
     ("VFS to access servers complying with the SNIA CIFS Specification "
      "e.g. Samba and Windows");
 MODULE_VERSION(CIFS_VERSION);
-async_module_init(init_cifs)
+module_init(init_cifs)
 module_exit(exit_cifs)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/fs/fat/inode.c linux-4.0.orig/fs/fat/inode.c
--- linux-4.0/fs/fat/inode.c	2015-04-20 21:09:50.276122613 +0100
+++ linux-4.0.orig/fs/fat/inode.c	2015-04-12 23:12:50.000000000 +0100
@@ -1855,7 +1855,7 @@ static void __exit exit_fat_fs(void)
 	fat_destroy_inodecache();
 }
 
-async_module_init(init_fat_fs)
+module_init(init_fat_fs)
 module_exit(exit_fat_fs)
 
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/fs/fat/namei_msdos.c linux-4.0.orig/fs/fat/namei_msdos.c
--- linux-4.0/fs/fat/namei_msdos.c	2015-04-20 21:09:50.278122613 +0100
+++ linux-4.0.orig/fs/fat/namei_msdos.c	2015-04-12 23:12:50.000000000 +0100
@@ -682,5 +682,5 @@ MODULE_LICENSE("GPL");
 MODULE_AUTHOR("Werner Almesberger");
 MODULE_DESCRIPTION("MS-DOS filesystem support");
 
-async_module_init(init_msdos_fs,init_fat_fs)
+module_init(init_msdos_fs)
 module_exit(exit_msdos_fs)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/fs/isofs/inode.c linux-4.0.orig/fs/isofs/inode.c
--- linux-4.0/fs/isofs/inode.c	2015-04-20 21:09:50.282122613 +0100
+++ linux-4.0.orig/fs/isofs/inode.c	2015-04-12 23:12:50.000000000 +0100
@@ -1552,6 +1552,6 @@ static void __exit exit_iso9660_fs(void)
 	destroy_inodecache();
 }
 
-async_module_init(init_iso9660_fs)
+module_init(init_iso9660_fs)
 module_exit(exit_iso9660_fs)
 MODULE_LICENSE("GPL");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/fs/ntfs/super.c linux-4.0.orig/fs/ntfs/super.c
--- linux-4.0/fs/ntfs/super.c	2015-04-20 21:09:50.289122613 +0100
+++ linux-4.0.orig/fs/ntfs/super.c	2015-04-12 23:12:50.000000000 +0100
@@ -3216,5 +3216,5 @@ module_param(debug_msgs, bint, 0);
 MODULE_PARM_DESC(debug_msgs, "Enable debug messages.");
 #endif
 
-async_module_init(init_ntfs_fs)
+module_init(init_ntfs_fs)
 module_exit(exit_ntfs_fs)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/include/acpi/acpi_bus.h linux-4.0.orig/include/acpi/acpi_bus.h
--- linux-4.0/include/acpi/acpi_bus.h	2015-04-19 15:58:42.657693097 +0100
+++ linux-4.0.orig/include/acpi/acpi_bus.h	2015-04-12 23:12:50.000000000 +0100
@@ -501,8 +501,8 @@ static inline bool acpi_device_enumerate
  * use this macro once, and calling it replaces module_init() and module_exit()
  */
 #define module_acpi_driver(__acpi_driver) \
-	async_module_driver(__acpi_driver, acpi_bus_register_driver, \
-		      acpi_bus_unregister_driver,acpi_ac_init)
+	module_driver(__acpi_driver, acpi_bus_register_driver, \
+		      acpi_bus_unregister_driver)
 
 /*
  * Bind physical devices with ACPI devices
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/include/asm-generic/vmlinux.lds.h linux-4.0.orig/include/asm-generic/vmlinux.lds.h
--- linux-4.0/include/asm-generic/vmlinux.lds.h	2015-04-18 20:37:03.854969071 +0100
+++ linux-4.0.orig/include/asm-generic/vmlinux.lds.h	2015-04-12 23:12:50.000000000 +0100
@@ -632,11 +632,6 @@
 		*(.initcall##level##.init)				\
 		*(.initcall##level##s.init)				\
 
-#define ASYNC_INITCALLS           \
-   VMLINUX_SYMBOL(__async_initcall_start) = .;    \
-   *(.async_initcall.init)        \
-   VMLINUX_SYMBOL(__async_initcall_end) = .;
-
 #define INIT_CALLS							\
 		VMLINUX_SYMBOL(__initcall_start) = .;			\
 		*(.initcallearly.init)					\
@@ -807,7 +802,6 @@
 		INIT_DATA						\
 		INIT_SETUP(initsetup_align)				\
 		INIT_CALLS						\
-		ASYNC_INITCALLS   \
 		CON_INITCALL						\
 		SECURITY_INITCALL					\
 		INIT_RAM_FS						\
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/include/linux/device.h linux-4.0.orig/include/linux/device.h
--- linux-4.0/include/linux/device.h	2015-04-20 21:13:04.133124905 +0100
+++ linux-4.0.orig/include/linux/device.h	2015-04-12 23:12:50.000000000 +0100
@@ -13,7 +13,6 @@
 #ifndef _DEVICE_H_
 #define _DEVICE_H_
 
-#include <linux/async_minit.h>
 #include <linux/ioport.h>
 #include <linux/kobject.h>
 #include <linux/klist.h>
@@ -1267,5 +1266,4 @@ static void __exit __driver##_exit(void)
 } \
 module_exit(__driver##_exit);
 
-
 #endif /* _DEVICE_H_ */
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/include/linux/module.h linux-4.0.orig/include/linux/module.h
--- linux-4.0/include/linux/module.h	2015-04-18 23:44:32.617102092 +0100
+++ linux-4.0.orig/include/linux/module.h	2015-04-12 23:12:50.000000000 +0100
@@ -6,7 +6,6 @@
  * Rewritten by Richard Henderson <rth@tamu.edu> Dec 1996
  * Rewritten again by Rusty Russell, 2002
  */
-#include "linux/async_minit.h"
 #include <linux/list.h>
 #include <linux/stat.h>
 #include <linux/compiler.h>
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/include/linux/pci.h linux-4.0.orig/include/linux/pci.h
--- linux-4.0/include/linux/pci.h	2015-04-19 16:23:27.773710659 +0100
+++ linux-4.0.orig/include/linux/pci.h	2015-04-12 23:12:50.000000000 +0100
@@ -1156,10 +1156,6 @@ void pci_unregister_driver(struct pci_dr
 	module_driver(__pci_driver, pci_register_driver, \
 		       pci_unregister_driver)
 
-#define async_module_pci_driver(__pci_driver) \
-  async_module_driver(__pci_driver, pci_register_driver, \
-           pci_unregister_driver,)
-
 struct pci_driver *pci_dev_driver(const struct pci_dev *dev);
 int pci_add_dynid(struct pci_driver *drv,
 		  unsigned int vendor, unsigned int device,
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/include/linux/usb.h linux-4.0.orig/include/linux/usb.h
--- linux-4.0/include/linux/usb.h	2015-04-19 16:26:19.533712690 +0100
+++ linux-4.0.orig/include/linux/usb.h	2015-04-12 23:12:50.000000000 +0100
@@ -1158,8 +1158,8 @@ extern void usb_deregister(struct usb_dr
  * use this macro once, and calling it replaces module_init() and module_exit()
  */
 #define module_usb_driver(__usb_driver) \
-	async_module_driver(__usb_driver, usb_register, \
-		       usb_deregister,)
+	module_driver(__usb_driver, usb_register, \
+		       usb_deregister)
 
 extern int usb_register_device_driver(struct usb_device_driver *,
 			struct module *);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/init/main.c linux-4.0.orig/init/main.c
--- linux-4.0/init/main.c	2015-04-18 22:19:31.372041768 +0100
+++ linux-4.0.orig/init/main.c	2015-04-12 23:12:50.000000000 +0100
@@ -928,7 +928,7 @@ static int __ref kernel_init(void *unuse
 	kernel_init_freeable();
 	/* need to finish all async __init code before freeing the memory */
 	async_synchronize_full();
-	//free_initmem();
+	free_initmem();
 	mark_rodata_ro();
 	system_state = SYSTEM_RUNNING;
 	numa_default_policy();
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/.project linux-4.0.orig/.project
--- linux-4.0/.project	2015-04-19 00:19:20.882126786 +0100
+++ linux-4.0.orig/.project	1970-01-01 01:00:00.000000000 +0100
@@ -1,26 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<projectDescription>
-	<name>linux-4.0</name>
-	<comment></comment>
-	<projects>
-	</projects>
-	<buildSpec>
-		<buildCommand>
-			<name>org.eclipse.cdt.managedbuilder.core.genmakebuilder</name>
-			<arguments>
-			</arguments>
-		</buildCommand>
-		<buildCommand>
-			<name>org.eclipse.cdt.managedbuilder.core.ScannerConfigBuilder</name>
-			<triggers>full,incremental,</triggers>
-			<arguments>
-			</arguments>
-		</buildCommand>
-	</buildSpec>
-	<natures>
-		<nature>org.eclipse.cdt.core.cnature</nature>
-		<nature>org.eclipse.cdt.core.ccnature</nature>
-		<nature>org.eclipse.cdt.managedbuilder.core.managedBuildNature</nature>
-		<nature>org.eclipse.cdt.managedbuilder.core.ScannerConfigNature</nature>
-	</natures>
-</projectDescription>
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/compress_offload.c linux-4.0.orig/sound/core/compress_offload.c
--- linux-4.0/sound/core/compress_offload.c	2015-04-19 21:37:18.763933343 +0100
+++ linux-4.0.orig/sound/core/compress_offload.c	2015-04-12 23:12:50.000000000 +0100
@@ -1002,7 +1002,7 @@ static void __exit snd_compress_exit(voi
 {
 }
 
-async_module_init(snd_compress_init);
+module_init(snd_compress_init);
 module_exit(snd_compress_exit);
 
 MODULE_DESCRIPTION("ALSA Compressed offload framework");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/hrtimer.c linux-4.0.orig/sound/core/hrtimer.c
--- linux-4.0/sound/core/hrtimer.c	2015-04-19 21:37:18.755933343 +0100
+++ linux-4.0.orig/sound/core/hrtimer.c	2015-04-12 23:12:50.000000000 +0100
@@ -162,5 +162,5 @@ static void __exit snd_hrtimer_exit(void
 	}
 }
 
-async_module_init(snd_hrtimer_init);
+module_init(snd_hrtimer_init);
 module_exit(snd_hrtimer_exit);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/hwdep.c linux-4.0.orig/sound/core/hwdep.c
--- linux-4.0/sound/core/hwdep.c	2015-04-19 21:53:43.605944989 +0100
+++ linux-4.0.orig/sound/core/hwdep.c	2015-04-12 23:12:50.000000000 +0100
@@ -548,5 +548,5 @@ static void __exit alsa_hwdep_exit(void)
 	snd_hwdep_proc_done();
 }
 
-async_module_init(alsa_hwdep_init);
+module_init(alsa_hwdep_init)
 module_exit(alsa_hwdep_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/oss/mixer_oss.c linux-4.0.orig/sound/core/oss/mixer_oss.c
--- linux-4.0/sound/core/oss/mixer_oss.c	2015-04-19 21:37:18.954933345 +0100
+++ linux-4.0.orig/sound/core/oss/mixer_oss.c	2015-04-12 23:12:50.000000000 +0100
@@ -1418,7 +1418,7 @@ static void __exit alsa_mixer_oss_exit(v
 	}
 }
 
-async_module_init(alsa_mixer_oss_init)
+module_init(alsa_mixer_oss_init)
 module_exit(alsa_mixer_oss_exit)
 
 EXPORT_SYMBOL(snd_mixer_oss_ioctl_card);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/oss/pcm_oss.c linux-4.0.orig/sound/core/oss/pcm_oss.c
--- linux-4.0/sound/core/oss/pcm_oss.c	2015-04-19 21:37:18.944933345 +0100
+++ linux-4.0.orig/sound/core/oss/pcm_oss.c	2015-04-12 23:12:50.000000000 +0100
@@ -3108,5 +3108,5 @@ static void __exit alsa_pcm_oss_exit(voi
 	snd_pcm_notify(&snd_pcm_oss_notify, 1);
 }
 
-async_module_init(alsa_pcm_oss_init)
+module_init(alsa_pcm_oss_init)
 module_exit(alsa_pcm_oss_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/pcm.c linux-4.0.orig/sound/core/pcm.c
--- linux-4.0/sound/core/pcm.c	2015-04-19 21:37:18.741933343 +0100
+++ linux-4.0.orig/sound/core/pcm.c	2015-04-12 23:12:50.000000000 +0100
@@ -1269,5 +1269,5 @@ static void __exit alsa_pcm_exit(void)
 	snd_pcm_proc_done();
 }
 
-async_module_init(alsa_pcm_init)
+module_init(alsa_pcm_init)
 module_exit(alsa_pcm_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/rawmidi.c linux-4.0.orig/sound/core/rawmidi.c
--- linux-4.0/sound/core/rawmidi.c	2015-04-19 21:37:18.674933342 +0100
+++ linux-4.0.orig/sound/core/rawmidi.c	2015-04-12 23:12:50.000000000 +0100
@@ -1739,5 +1739,5 @@ static void __exit alsa_rawmidi_exit(voi
 	snd_ctl_unregister_ioctl_compat(snd_rawmidi_control_ioctl);
 }
 
-async_module_init(alsa_rawmidi_init)
+module_init(alsa_rawmidi_init)
 module_exit(alsa_rawmidi_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/rtctimer.c linux-4.0.orig/sound/core/rtctimer.c
--- linux-4.0/sound/core/rtctimer.c	2015-04-19 21:37:18.662933342 +0100
+++ linux-4.0.orig/sound/core/rtctimer.c	2015-04-12 23:12:50.000000000 +0100
@@ -174,7 +174,7 @@ static void __exit rtctimer_exit(void)
 /*
  * exported stuff
  */
-async_module_init(rtctimer_init)
+module_init(rtctimer_init)
 module_exit(rtctimer_exit)
 
 module_param(rtctimer_freq, int, 0444);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/seq/oss/seq_oss.c linux-4.0.orig/sound/core/seq/oss/seq_oss.c
--- linux-4.0/sound/core/seq/oss/seq_oss.c	2015-04-19 21:37:18.933933345 +0100
+++ linux-4.0.orig/sound/core/seq/oss/seq_oss.c	2015-04-12 23:12:50.000000000 +0100
@@ -110,7 +110,7 @@ static void __exit alsa_seq_oss_exit(voi
 	unregister_device();
 }
 
-async_module_init(alsa_seq_oss_init)
+module_init(alsa_seq_oss_init)
 module_exit(alsa_seq_oss_exit)
 
 /*
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/seq/seq.c linux-4.0.orig/sound/core/seq/seq.c
--- linux-4.0/sound/core/seq/seq.c	2015-04-19 21:37:18.771933343 +0100
+++ linux-4.0.orig/sound/core/seq/seq.c	2015-04-12 23:12:50.000000000 +0100
@@ -134,5 +134,5 @@ static void __exit alsa_seq_exit(void)
 	snd_seq_autoload_exit();
 }
 
-async_module_init(alsa_seq_init)
+module_init(alsa_seq_init)
 module_exit(alsa_seq_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/seq/seq_device.c linux-4.0.orig/sound/core/seq/seq_device.c
--- linux-4.0/sound/core/seq/seq_device.c	2015-04-19 21:37:18.875933344 +0100
+++ linux-4.0.orig/sound/core/seq/seq_device.c	2015-04-12 23:12:50.000000000 +0100
@@ -602,7 +602,7 @@ static void __exit alsa_seq_device_exit(
 		pr_err("ALSA: seq: drivers not released (%d)\n", num_ops);
 }
 
-async_module_init(alsa_seq_device_init)
+module_init(alsa_seq_device_init)
 module_exit(alsa_seq_device_exit)
 
 EXPORT_SYMBOL(snd_seq_device_load_drivers);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/seq/seq_dummy.c linux-4.0.orig/sound/core/seq/seq_dummy.c
--- linux-4.0/sound/core/seq/seq_dummy.c	2015-04-19 21:37:18.867933344 +0100
+++ linux-4.0.orig/sound/core/seq/seq_dummy.c	2015-04-12 23:12:50.000000000 +0100
@@ -226,5 +226,5 @@ static void __exit alsa_seq_dummy_exit(v
 	delete_client();
 }
 
-async_module_init(alsa_seq_dummy_init)
+module_init(alsa_seq_dummy_init)
 module_exit(alsa_seq_dummy_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/seq/seq_midi.c linux-4.0.orig/sound/core/seq/seq_midi.c
--- linux-4.0/sound/core/seq/seq_midi.c	2015-04-19 21:37:18.837933344 +0100
+++ linux-4.0.orig/sound/core/seq/seq_midi.c	2015-04-12 23:12:50.000000000 +0100
@@ -476,5 +476,5 @@ static void __exit alsa_seq_midi_exit(vo
 	snd_seq_device_unregister_driver(SNDRV_SEQ_DEV_ID_MIDISYNTH);
 }
 
-async_module_init(alsa_seq_midi_init)
+module_init(alsa_seq_midi_init)
 module_exit(alsa_seq_midi_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/seq/seq_midi_emul.c linux-4.0.orig/sound/core/seq/seq_midi_emul.c
--- linux-4.0/sound/core/seq/seq_midi_emul.c	2015-04-19 21:37:18.857933344 +0100
+++ linux-4.0.orig/sound/core/seq/seq_midi_emul.c	2015-04-12 23:12:50.000000000 +0100
@@ -734,7 +734,7 @@ static void __exit alsa_seq_midi_emul_ex
 {
 }
 
-async_module_init(alsa_seq_midi_emul_init)
+module_init(alsa_seq_midi_emul_init)
 module_exit(alsa_seq_midi_emul_exit)
 
 EXPORT_SYMBOL(snd_midi_process_event);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/seq/seq_midi_event.c linux-4.0.orig/sound/core/seq/seq_midi_event.c
--- linux-4.0/sound/core/seq/seq_midi_event.c	2015-04-19 21:37:18.845933344 +0100
+++ linux-4.0.orig/sound/core/seq/seq_midi_event.c	2015-04-12 23:12:50.000000000 +0100
@@ -546,5 +546,5 @@ static void __exit alsa_seq_midi_event_e
 {
 }
 
-async_module_init(alsa_seq_midi_event_init)
+module_init(alsa_seq_midi_event_init)
 module_exit(alsa_seq_midi_event_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/seq/seq_virmidi.c linux-4.0.orig/sound/core/seq/seq_virmidi.c
--- linux-4.0/sound/core/seq/seq_virmidi.c	2015-04-19 21:37:18.778933343 +0100
+++ linux-4.0.orig/sound/core/seq/seq_virmidi.c	2015-04-12 23:12:50.000000000 +0100
@@ -537,7 +537,7 @@ static void __exit alsa_virmidi_exit(voi
 {
 }
 
-async_module_init(alsa_virmidi_init)
+module_init(alsa_virmidi_init)
 module_exit(alsa_virmidi_exit)
 
 EXPORT_SYMBOL(snd_virmidi_new);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/core/timer.c linux-4.0.orig/sound/core/timer.c
--- linux-4.0/sound/core/timer.c	2015-04-19 21:37:18.638933342 +0100
+++ linux-4.0.orig/sound/core/timer.c	2015-04-12 23:12:50.000000000 +0100
@@ -1998,7 +1998,7 @@ static void __exit alsa_timer_exit(void)
 #endif
 }
 
-async_module_init(alsa_timer_init)
+module_init(alsa_timer_init)
 module_exit(alsa_timer_exit)
 
 EXPORT_SYMBOL(snd_timer_open);
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/drivers/aloop.c linux-4.0.orig/sound/drivers/aloop.c
--- linux-4.0/sound/drivers/aloop.c	2015-04-19 21:37:18.455933339 +0100
+++ linux-4.0.orig/sound/drivers/aloop.c	2015-04-12 23:12:50.000000000 +0100
@@ -1272,5 +1272,5 @@ static void __exit alsa_card_loopback_ex
 	loopback_unregister_all();
 }
 
-async_module_init(alsa_card_loopback_init)
+module_init(alsa_card_loopback_init)
 module_exit(alsa_card_loopback_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/drivers/dummy.c linux-4.0.orig/sound/drivers/dummy.c
--- linux-4.0/sound/drivers/dummy.c	2015-04-19 21:37:18.441933339 +0100
+++ linux-4.0.orig/sound/drivers/dummy.c	2015-04-12 23:12:50.000000000 +0100
@@ -1219,5 +1219,5 @@ static void __exit alsa_card_dummy_exit(
 	snd_dummy_unregister_all();
 }
 
-async_module_init(alsa_card_dummy_init)
+module_init(alsa_card_dummy_init)
 module_exit(alsa_card_dummy_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/drivers/mpu401/mpu401.c linux-4.0.orig/sound/drivers/mpu401/mpu401.c
--- linux-4.0/sound/drivers/mpu401/mpu401.c	2015-04-19 21:37:18.549933340 +0100
+++ linux-4.0.orig/sound/drivers/mpu401/mpu401.c	2015-04-12 23:12:50.000000000 +0100
@@ -283,5 +283,5 @@ static void __exit alsa_card_mpu401_exit
 	snd_mpu401_unregister_all();
 }
 
-async_module_init(alsa_card_mpu401_init)
+module_init(alsa_card_mpu401_init)
 module_exit(alsa_card_mpu401_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/drivers/mpu401/mpu401_uart.c linux-4.0.orig/sound/drivers/mpu401/mpu401_uart.c
--- linux-4.0/sound/drivers/mpu401/mpu401_uart.c	2015-04-19 21:37:18.570933341 +0100
+++ linux-4.0.orig/sound/drivers/mpu401/mpu401_uart.c	2015-04-12 23:12:50.000000000 +0100
@@ -630,5 +630,5 @@ static void __exit alsa_mpu401_uart_exit
 {
 }
 
-async_module_init(alsa_mpu401_uart_init)
+module_init(alsa_mpu401_uart_init)
 module_exit(alsa_mpu401_uart_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/drivers/virmidi.c linux-4.0.orig/sound/drivers/virmidi.c
--- linux-4.0/sound/drivers/virmidi.c	2015-04-19 21:37:18.430933339 +0100
+++ linux-4.0.orig/sound/drivers/virmidi.c	2015-04-12 23:12:50.000000000 +0100
@@ -195,5 +195,5 @@ static void __exit alsa_card_virmidi_exi
 	snd_virmidi_unregister_all();
 }
 
-async_module_init(alsa_card_virmidi_init)
+module_init(alsa_card_virmidi_init)
 module_exit(alsa_card_virmidi_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/oss/soundcard.c linux-4.0.orig/sound/oss/soundcard.c
--- linux-4.0/sound/oss/soundcard.c	2015-04-19 21:37:17.809933332 +0100
+++ linux-4.0.orig/sound/oss/soundcard.c	2015-04-12 23:12:50.000000000 +0100
@@ -599,7 +599,7 @@ static void __exit oss_cleanup(void)
 
 }
 
-async_module_init(oss_init);
+module_init(oss_init);
 module_exit(oss_cleanup);
 MODULE_LICENSE("GPL");
 MODULE_DESCRIPTION("OSS Sound subsystem");
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_analog.c linux-4.0.orig/sound/pci/hda/patch_analog.c
--- linux-4.0/sound/pci/hda/patch_analog.c	2015-04-19 21:37:18.422933339 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_analog.c	2015-04-12 23:12:50.000000000 +0100
@@ -1209,5 +1209,5 @@ static void __exit patch_analog_exit(voi
 	snd_hda_delete_codec_preset(&analog_list);
 }
 
-async_module_init(patch_analog_init)
+module_init(patch_analog_init)
 module_exit(patch_analog_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_ca0110.c linux-4.0.orig/sound/pci/hda/patch_ca0110.c
--- linux-4.0/sound/pci/hda/patch_ca0110.c	2015-04-19 21:37:18.411933339 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_ca0110.c	2015-04-12 23:12:50.000000000 +0100
@@ -113,5 +113,5 @@ static void __exit patch_ca0110_exit(voi
 	snd_hda_delete_codec_preset(&ca0110_list);
 }
 
-async_module_init(patch_ca0110_init)
+module_init(patch_ca0110_init)
 module_exit(patch_ca0110_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_ca0132.c linux-4.0.orig/sound/pci/hda/patch_ca0132.c
--- linux-4.0/sound/pci/hda/patch_ca0132.c	2015-04-19 21:37:18.345933338 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_ca0132.c	2015-04-12 23:12:50.000000000 +0100
@@ -4717,5 +4717,5 @@ static void __exit patch_ca0132_exit(voi
 	snd_hda_delete_codec_preset(&ca0132_list);
 }
 
-async_module_init(patch_ca0132_init)
+module_init(patch_ca0132_init)
 module_exit(patch_ca0132_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_cirrus.c linux-4.0.orig/sound/pci/hda/patch_cirrus.c
--- linux-4.0/sound/pci/hda/patch_cirrus.c	2015-04-19 21:37:18.311933338 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_cirrus.c	2015-04-12 23:12:50.000000000 +0100
@@ -1236,5 +1236,5 @@ static void __exit patch_cirrus_exit(voi
 	snd_hda_delete_codec_preset(&cirrus_list);
 }
 
-async_module_init(patch_cirrus_init)
+module_init(patch_cirrus_init)
 module_exit(patch_cirrus_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_cmedia.c linux-4.0.orig/sound/pci/hda/patch_cmedia.c
--- linux-4.0/sound/pci/hda/patch_cmedia.c	2015-04-19 21:37:18.301933338 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_cmedia.c	2015-04-12 23:12:50.000000000 +0100
@@ -152,5 +152,5 @@ static void __exit patch_cmedia_exit(voi
 	snd_hda_delete_codec_preset(&cmedia_list);
 }
 
-async_module_init(patch_cmedia_init)
+module_init(patch_cmedia_init)
 module_exit(patch_cmedia_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_conexant.c linux-4.0.orig/sound/pci/hda/patch_conexant.c
--- linux-4.0/sound/pci/hda/patch_conexant.c	2015-04-19 21:37:18.246933337 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_conexant.c	2015-04-12 23:12:50.000000000 +0100
@@ -1033,5 +1033,5 @@ static void __exit patch_conexant_exit(v
 	snd_hda_delete_codec_preset(&conexant_list);
 }
 
-async_module_init(patch_conexant_init)
+module_init(patch_conexant_init)
 module_exit(patch_conexant_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_hdmi.c linux-4.0.orig/sound/pci/hda/patch_hdmi.c
--- linux-4.0/sound/pci/hda/patch_hdmi.c	2015-04-19 21:37:18.175933336 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_hdmi.c	2015-04-12 23:12:50.000000000 +0100
@@ -3457,5 +3457,5 @@ static void __exit patch_hdmi_exit(void)
 	snd_hda_delete_codec_preset(&intel_list);
 }
 
-async_module_init(patch_hdmi_init)
+module_init(patch_hdmi_init)
 module_exit(patch_hdmi_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_realtek.c linux-4.0.orig/sound/pci/hda/patch_realtek.c
--- linux-4.0/sound/pci/hda/patch_realtek.c	2015-04-19 21:37:18.111933335 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_realtek.c	2015-04-12 23:12:50.000000000 +0100
@@ -6564,5 +6564,5 @@ static void __exit patch_realtek_exit(vo
 	snd_hda_delete_codec_preset(&realtek_list);
 }
 
-async_module_init(patch_realtek_init)
+module_init(patch_realtek_init)
 module_exit(patch_realtek_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_si3054.c linux-4.0.orig/sound/pci/hda/patch_si3054.c
--- linux-4.0/sound/pci/hda/patch_si3054.c	2015-04-19 21:37:18.043933335 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_si3054.c	2015-04-12 23:12:50.000000000 +0100
@@ -334,5 +334,5 @@ static void __exit patch_si3054_exit(voi
 	snd_hda_delete_codec_preset(&si3054_list);
 }
 
-async_module_init(patch_si3054_init)
+module_init(patch_si3054_init)
 module_exit(patch_si3054_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_sigmatel.c linux-4.0.orig/sound/pci/hda/patch_sigmatel.c
--- linux-4.0/sound/pci/hda/patch_sigmatel.c	2015-04-19 21:37:17.987933334 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_sigmatel.c	2015-04-12 23:12:50.000000000 +0100
@@ -5106,5 +5106,5 @@ static void __exit patch_sigmatel_exit(v
 	snd_hda_delete_codec_preset(&sigmatel_list);
 }
 
-async_module_init(patch_sigmatel_init)
+module_init(patch_sigmatel_init)
 module_exit(patch_sigmatel_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/pci/hda/patch_via.c linux-4.0.orig/sound/pci/hda/patch_via.c
--- linux-4.0/sound/pci/hda/patch_via.c	2015-04-19 21:37:17.875933333 +0100
+++ linux-4.0.orig/sound/pci/hda/patch_via.c	2015-04-12 23:12:50.000000000 +0100
@@ -1902,5 +1902,5 @@ static void __exit patch_via_exit(void)
 	snd_hda_delete_codec_preset(&via_list);
 }
 
-async_module_init(patch_via_init)
+module_init(patch_via_init)
 module_exit(patch_via_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/ppc/powermac.c linux-4.0.orig/sound/ppc/powermac.c
--- linux-4.0/sound/ppc/powermac.c	2015-04-19 21:37:17.840933332 +0100
+++ linux-4.0.orig/sound/ppc/powermac.c	2015-04-12 23:12:50.000000000 +0100
@@ -190,5 +190,5 @@ static void __exit alsa_card_pmac_exit(v
 	platform_driver_unregister(&snd_pmac_driver);
 }
 
-async_module_init(alsa_card_pmac_init)
+module_init(alsa_card_pmac_init)
 module_exit(alsa_card_pmac_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/ppc/snd_ps3.c linux-4.0.orig/sound/ppc/snd_ps3.c
--- linux-4.0/sound/ppc/snd_ps3.c	2015-04-19 21:37:17.829933332 +0100
+++ linux-4.0.orig/sound/ppc/snd_ps3.c	2015-04-12 23:12:50.000000000 +0100
@@ -1147,7 +1147,7 @@ static int __init snd_ps3_init(void)
 
 	return ret;
 }
-async_module_init(snd_ps3_init);
+module_init(snd_ps3_init);
 
 static void __exit snd_ps3_exit(void)
 {
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/synth/emux/emux.c linux-4.0.orig/sound/synth/emux/emux.c
--- linux-4.0/sound/synth/emux/emux.c	2015-04-19 21:37:17.867933332 +0100
+++ linux-4.0.orig/sound/synth/emux/emux.c	2015-04-12 23:12:50.000000000 +0100
@@ -182,5 +182,5 @@ static void __exit alsa_emux_exit(void)
 {
 }
 
-async_module_init(alsa_emux_init)
+module_init(alsa_emux_init)
 module_exit(alsa_emux_exit)
diff -rupN --exclude .cproject '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0/sound/synth/util_mem.c linux-4.0.orig/sound/synth/util_mem.c
--- linux-4.0/sound/synth/util_mem.c	2015-04-19 21:37:17.860933332 +0100
+++ linux-4.0.orig/sound/synth/util_mem.c	2015-04-12 23:12:50.000000000 +0100
@@ -207,5 +207,5 @@ static void __exit alsa_util_mem_exit(vo
 {
 }
 
-async_module_init(alsa_util_mem_init)
+module_init(alsa_util_mem_init)
 module_exit(alsa_util_mem_exit)
