Only in linux-4.0/arch/x86/vdso: vdso-image-32-int80.c
Only in linux-4.0/arch/x86/vdso: vdso-image-32-sysenter.c
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/aes_generic.c linux-4.0/crypto/aes_generic.c
--- linux-4.0.orig/crypto/aes_generic.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/aes_generic.c	2015-04-27 16:45:54.010395857 +0100
@@ -1469,7 +1469,7 @@ static void __exit aes_fini(void)
 	crypto_unregister_alg(&aes_alg);
 }
 
-module_init(aes_init);
+deferred_module_init(aes_init);
 module_exit(aes_fini);
 
 MODULE_DESCRIPTION("Rijndael (AES) Cipher Algorithm");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/af_alg.c linux-4.0/crypto/af_alg.c
--- linux-4.0.orig/crypto/af_alg.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/af_alg.c	2015-04-21 15:20:04.819998117 +0100
@@ -477,7 +477,7 @@ static void __exit af_alg_exit(void)
 	proto_unregister(&alg_proto);
 }
 
-module_init(af_alg_init);
+module_init(af_alg_init);	// allow algif_hash algif_skcipher
 module_exit(af_alg_exit);
 MODULE_LICENSE("GPL");
 MODULE_ALIAS_NETPROTO(AF_ALG);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/algif_hash.c linux-4.0/crypto/algif_hash.c
--- linux-4.0.orig/crypto/algif_hash.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/algif_hash.c	2015-04-21 09:50:43.257680224 +0100
@@ -308,6 +308,6 @@ static void __exit algif_hash_exit(void)
 	BUG_ON(err);
 }
 
-module_init(algif_hash_init);
+module_init(algif_hash_init);	//af_alg_init
 module_exit(algif_hash_exit);
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/algif_skcipher.c linux-4.0/crypto/algif_skcipher.c
--- linux-4.0.orig/crypto/algif_skcipher.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/algif_skcipher.c	2015-04-21 09:51:35.845678339 +0100
@@ -626,6 +626,6 @@ static void __exit algif_skcipher_exit(v
 	BUG_ON(err);
 }
 
-module_init(algif_skcipher_init);
+module_init(algif_skcipher_init);		//af_alg_init
 module_exit(algif_skcipher_exit);
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/ansi_cprng.c linux-4.0/crypto/ansi_cprng.c
--- linux-4.0.orig/crypto/ansi_cprng.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/ansi_cprng.c	2015-04-27 16:45:54.022395944 +0100
@@ -474,7 +474,7 @@ MODULE_DESCRIPTION("Software Pseudo Rand
 MODULE_AUTHOR("Neil Horman <nhorman@tuxdriver.com>");
 module_param(dbg, int, 0);
 MODULE_PARM_DESC(dbg, "Boolean to enable debugging (0/1 == off/on)");
-module_init(prng_mod_init);
+deferred_module_init(prng_mod_init);
 module_exit(prng_mod_fini);
 MODULE_ALIAS_CRYPTO("stdrng");
 MODULE_ALIAS_CRYPTO("ansi_cprng");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/asymmetric_keys/asymmetric_type.c linux-4.0/crypto/asymmetric_keys/asymmetric_type.c
--- linux-4.0.orig/crypto/asymmetric_keys/asymmetric_type.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/asymmetric_keys/asymmetric_type.c	2015-04-27 16:45:54.022395944 +0100
@@ -402,5 +402,5 @@ static void __exit asymmetric_key_cleanu
 	unregister_key_type(&key_type_asymmetric);
 }
 
-module_init(asymmetric_key_init);
+deferred_module_init(asymmetric_key_init);
 module_exit(asymmetric_key_cleanup);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/asymmetric_keys/pkcs7_key_type.c linux-4.0/crypto/asymmetric_keys/pkcs7_key_type.c
--- linux-4.0.orig/crypto/asymmetric_keys/pkcs7_key_type.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/asymmetric_keys/pkcs7_key_type.c	2015-04-27 16:45:54.034395979 +0100
@@ -94,5 +94,5 @@ static void __exit pkcs7_key_cleanup(voi
 	unregister_key_type(&key_type_pkcs7);
 }
 
-module_init(pkcs7_key_init);
+deferred_module_init(pkcs7_key_init);
 module_exit(pkcs7_key_cleanup);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/asymmetric_keys/x509_public_key.c linux-4.0/crypto/asymmetric_keys/x509_public_key.c
--- linux-4.0.orig/crypto/asymmetric_keys/x509_public_key.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/asymmetric_keys/x509_public_key.c	2015-04-27 16:45:54.046396052 +0100
@@ -357,7 +357,7 @@ static void __exit x509_key_exit(void)
 	unregister_asymmetric_key_parser(&x509_key_parser);
 }
 
-module_init(x509_key_init);
+deferred_module_init(x509_key_init);
 module_exit(x509_key_exit);
 
 MODULE_DESCRIPTION("X.509 certificate parser");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/async_tx/async_pq.c linux-4.0/crypto/async_tx/async_pq.c
--- linux-4.0.orig/crypto/async_tx/async_pq.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/async_tx/async_pq.c	2015-04-21 14:27:40.688727838 +0100
@@ -434,7 +434,7 @@ static void __exit async_pq_exit(void)
 	put_page(pq_scribble_page);
 }
 
-module_init(async_pq_init);
+module_init(async_pq_init);	//raid6_pq.ko async_xor.ko async_tx.ko
 module_exit(async_pq_exit);
 
 MODULE_DESCRIPTION("asynchronous raid6 syndrome generation/validation");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/blowfish_generic.c linux-4.0/crypto/blowfish_generic.c
--- linux-4.0.orig/crypto/blowfish_generic.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/blowfish_generic.c	2015-04-27 16:45:54.046396052 +0100
@@ -133,7 +133,7 @@ static void __exit blowfish_mod_fini(voi
 	crypto_unregister_alg(&alg);
 }
 
-module_init(blowfish_mod_init);
+deferred_module_init(blowfish_mod_init);	//blowfish_common.ko
 module_exit(blowfish_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/cbc.c linux-4.0/crypto/cbc.c
--- linux-4.0.orig/crypto/cbc.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/cbc.c	2015-04-27 16:45:54.046396052 +0100
@@ -284,7 +284,7 @@ static void __exit crypto_cbc_module_exi
 	crypto_unregister_template(&crypto_cbc_tmpl);
 }
 
-module_init(crypto_cbc_module_init);
+deferred_module_init(crypto_cbc_module_init);
 module_exit(crypto_cbc_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/crc32.c linux-4.0/crypto/crc32.c
--- linux-4.0.orig/crypto/crc32.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/crc32.c	2015-04-27 16:45:54.062396127 +0100
@@ -150,7 +150,7 @@ static void __exit crc32_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-module_init(crc32_mod_init);
+deferred_module_init(crc32_mod_init);
 module_exit(crc32_mod_fini);
 
 MODULE_AUTHOR("Alexander Boyko <alexander_boyko@xyratex.com>");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/crc32c_generic.c linux-4.0/crypto/crc32c_generic.c
--- linux-4.0.orig/crypto/crc32c_generic.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/crc32c_generic.c	2015-04-27 16:45:54.062396127 +0100
@@ -164,7 +164,7 @@ static void __exit crc32c_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-module_init(crc32c_mod_init);
+deferred_module_init(crc32c_mod_init);
 module_exit(crc32c_mod_fini);
 
 MODULE_AUTHOR("Clay Haapala <chaapala@cisco.com>");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/crct10dif_generic.c linux-4.0/crypto/crct10dif_generic.c
--- linux-4.0.orig/crypto/crct10dif_generic.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/crct10dif_generic.c	2015-04-27 16:45:54.062396127 +0100
@@ -118,7 +118,7 @@ static void __exit crct10dif_mod_fini(vo
 	crypto_unregister_shash(&alg);
 }
 
-module_init(crct10dif_mod_init);
+deferred_module_init(crct10dif_mod_init);
 module_exit(crct10dif_mod_fini);
 
 MODULE_AUTHOR("Tim Chen <tim.c.chen@linux.intel.com>");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/crypto_null.c linux-4.0/crypto/crypto_null.c
--- linux-4.0.orig/crypto/crypto_null.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/crypto_null.c	2015-04-27 16:45:54.062396127 +0100
@@ -175,7 +175,7 @@ static void __exit crypto_null_mod_fini(
 	crypto_unregister_algs(null_algs, ARRAY_SIZE(null_algs));
 }
 
-module_init(crypto_null_mod_init);
+deferred_module_init(crypto_null_mod_init);
 module_exit(crypto_null_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/crypto_user.c linux-4.0/crypto/crypto_user.c
--- linux-4.0.orig/crypto/crypto_user.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/crypto_user.c	2015-04-27 16:45:54.066396144 +0100
@@ -529,7 +529,7 @@ static void __exit crypto_user_exit(void
 	netlink_kernel_release(crypto_nlsk);
 }
 
-module_init(crypto_user_init);
+deferred_module_init(crypto_user_init);
 module_exit(crypto_user_exit);
 MODULE_LICENSE("GPL");
 MODULE_AUTHOR("Steffen Klassert <steffen.klassert@secunet.com>");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/deflate.c linux-4.0/crypto/deflate.c
--- linux-4.0.orig/crypto/deflate.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/deflate.c	2015-04-21 14:28:17.399075375 +0100
@@ -216,7 +216,7 @@ static void __exit deflate_mod_fini(void
 	crypto_unregister_alg(&alg);
 }
 
-module_init(deflate_mod_init);
+module_init(deflate_mod_init);	//zlib_deflate
 module_exit(deflate_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/ecb.c linux-4.0/crypto/ecb.c
--- linux-4.0.orig/crypto/ecb.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/ecb.c	2015-04-27 16:45:54.070396164 +0100
@@ -180,7 +180,7 @@ static void __exit crypto_ecb_module_exi
 	crypto_unregister_template(&crypto_ecb_tmpl);
 }
 
-module_init(crypto_ecb_module_init);
+deferred_module_init(crypto_ecb_module_init);
 module_exit(crypto_ecb_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/ghash-generic.c linux-4.0/crypto/ghash-generic.c
--- linux-4.0.orig/crypto/ghash-generic.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/ghash-generic.c	2015-04-21 14:28:17.387069373 +0100
@@ -167,7 +167,7 @@ static void __exit ghash_mod_exit(void)
 	crypto_unregister_shash(&ghash_alg);
 }
 
-module_init(ghash_mod_init);
+module_init(ghash_mod_init);	//gf128mul
 module_exit(ghash_mod_exit);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/lrw.c linux-4.0/crypto/lrw.c
--- linux-4.0.orig/crypto/lrw.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/lrw.c	2015-04-27 16:45:54.070396164 +0100
@@ -395,7 +395,7 @@ static void __exit crypto_module_exit(vo
 	crypto_unregister_template(&crypto_tmpl);
 }
 
-module_init(crypto_module_init);
+deferred_module_init(crypto_module_init);	//gf128mul
 module_exit(crypto_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/lz4.c linux-4.0/crypto/lz4.c
--- linux-4.0.orig/crypto/lz4.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/lz4.c	2015-04-27 16:45:54.074396192 +0100
@@ -99,7 +99,7 @@ static void __exit lz4_mod_fini(void)
 	crypto_unregister_alg(&alg_lz4);
 }
 
-module_init(lz4_mod_init);
+deferred_module_init(lz4_mod_init);
 module_exit(lz4_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/lz4hc.c linux-4.0/crypto/lz4hc.c
--- linux-4.0.orig/crypto/lz4hc.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/lz4hc.c	2015-04-27 16:45:54.078396203 +0100
@@ -99,7 +99,7 @@ static void __exit lz4hc_mod_fini(void)
 	crypto_unregister_alg(&alg_lz4hc);
 }
 
-module_init(lz4hc_mod_init);
+deferred_module_init(lz4hc_mod_init);
 module_exit(lz4hc_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/lzo.c linux-4.0/crypto/lzo.c
--- linux-4.0.orig/crypto/lzo.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/lzo.c	2015-04-27 16:45:54.078396203 +0100
@@ -102,7 +102,7 @@ static void __exit lzo_mod_fini(void)
 	crypto_unregister_alg(&alg);
 }
 
-module_init(lzo_mod_init);
+deferred_module_init(lzo_mod_init);
 module_exit(lzo_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/md4.c linux-4.0/crypto/md4.c
--- linux-4.0.orig/crypto/md4.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/md4.c	2015-04-27 16:45:54.082396214 +0100
@@ -250,7 +250,7 @@ static void __exit md4_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-module_init(md4_mod_init);
+deferred_module_init(md4_mod_init);
 module_exit(md4_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/md5.c linux-4.0/crypto/md5.c
--- linux-4.0.orig/crypto/md5.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/md5.c	2015-04-27 16:45:54.086396237 +0100
@@ -163,7 +163,7 @@ static void __exit md5_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-module_init(md5_mod_init);
+deferred_module_init(md5_mod_init);
 module_exit(md5_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/rmd128.c linux-4.0/crypto/rmd128.c
--- linux-4.0.orig/crypto/rmd128.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/rmd128.c	2015-04-27 16:45:54.106396335 +0100
@@ -321,7 +321,7 @@ static void __exit rmd128_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-module_init(rmd128_mod_init);
+deferred_module_init(rmd128_mod_init);
 module_exit(rmd128_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/rmd160.c linux-4.0/crypto/rmd160.c
--- linux-4.0.orig/crypto/rmd160.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/rmd160.c	2015-04-27 16:45:54.106396335 +0100
@@ -365,7 +365,7 @@ static void __exit rmd160_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-module_init(rmd160_mod_init);
+deferred_module_init(rmd160_mod_init);
 module_exit(rmd160_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/rmd256.c linux-4.0/crypto/rmd256.c
--- linux-4.0.orig/crypto/rmd256.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/rmd256.c	2015-04-27 16:45:54.118396404 +0100
@@ -340,7 +340,7 @@ static void __exit rmd256_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-module_init(rmd256_mod_init);
+deferred_module_init(rmd256_mod_init);
 module_exit(rmd256_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/rmd320.c linux-4.0/crypto/rmd320.c
--- linux-4.0.orig/crypto/rmd320.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/rmd320.c	2015-04-27 16:45:54.118396404 +0100
@@ -389,7 +389,7 @@ static void __exit rmd320_mod_fini(void)
 	crypto_unregister_shash(&alg);
 }
 
-module_init(rmd320_mod_init);
+deferred_module_init(rmd320_mod_init);
 module_exit(rmd320_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/sha1_generic.c linux-4.0/crypto/sha1_generic.c
--- linux-4.0.orig/crypto/sha1_generic.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/sha1_generic.c	2015-04-27 16:45:54.130396461 +0100
@@ -147,7 +147,7 @@ static void __exit sha1_generic_mod_fini
 	crypto_unregister_shash(&alg);
 }
 
-module_init(sha1_generic_mod_init);
+deferred_module_init(sha1_generic_mod_init);
 module_exit(sha1_generic_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/sha256_generic.c linux-4.0/crypto/sha256_generic.c
--- linux-4.0.orig/crypto/sha256_generic.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/sha256_generic.c	2015-04-27 16:45:54.130396461 +0100
@@ -378,7 +378,7 @@ static void __exit sha256_generic_mod_fi
 	crypto_unregister_shashes(sha256_algs, ARRAY_SIZE(sha256_algs));
 }
 
-module_init(sha256_generic_mod_init);
+deferred_module_init(sha256_generic_mod_init);
 module_exit(sha256_generic_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/sha512_generic.c linux-4.0/crypto/sha512_generic.c
--- linux-4.0.orig/crypto/sha512_generic.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/sha512_generic.c	2015-04-27 16:45:54.130396461 +0100
@@ -282,7 +282,7 @@ static void __exit sha512_generic_mod_fi
 	crypto_unregister_shashes(sha512_algs, ARRAY_SIZE(sha512_algs));
 }
 
-module_init(sha512_generic_mod_init);
+deferred_module_init(sha512_generic_mod_init);
 module_exit(sha512_generic_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/tcrypt.c linux-4.0/crypto/tcrypt.c
--- linux-4.0.orig/crypto/tcrypt.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/tcrypt.c	2015-04-27 16:45:54.134396472 +0100
@@ -2188,7 +2188,7 @@ err_free_tv:
  */
 static void __exit tcrypt_mod_fini(void) { }
 
-module_init(tcrypt_mod_init);
+deferred_module_init(tcrypt_mod_init);
 module_exit(tcrypt_mod_fini);
 
 module_param(alg, charp, 0);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/tea.c linux-4.0/crypto/tea.c
--- linux-4.0.orig/crypto/tea.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/tea.c	2015-04-27 16:45:54.138396495 +0100
@@ -274,7 +274,7 @@ MODULE_ALIAS_CRYPTO("tea");
 MODULE_ALIAS_CRYPTO("xtea");
 MODULE_ALIAS_CRYPTO("xeta");
 
-module_init(tea_mod_init);
+deferred_module_init(tea_mod_init);
 module_exit(tea_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/tgr192.c linux-4.0/crypto/tgr192.c
--- linux-4.0.orig/crypto/tgr192.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/tgr192.c	2015-04-27 16:45:54.142396535 +0100
@@ -680,7 +680,7 @@ MODULE_ALIAS_CRYPTO("tgr192");
 MODULE_ALIAS_CRYPTO("tgr160");
 MODULE_ALIAS_CRYPTO("tgr128");
 
-module_init(tgr192_mod_init);
+deferred_module_init(tgr192_mod_init);
 module_exit(tgr192_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/twofish_generic.c linux-4.0/crypto/twofish_generic.c
--- linux-4.0.orig/crypto/twofish_generic.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/twofish_generic.c	2015-04-27 16:45:54.142396535 +0100
@@ -206,7 +206,7 @@ static void __exit twofish_mod_fini(void
 	crypto_unregister_alg(&alg);
 }
 
-module_init(twofish_mod_init);
+deferred_module_init(twofish_mod_init);	//twofish_common
 module_exit(twofish_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/vmac.c linux-4.0/crypto/vmac.c
--- linux-4.0.orig/crypto/vmac.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/vmac.c	2015-04-27 16:45:54.146396546 +0100
@@ -708,7 +708,7 @@ static void __exit vmac_module_exit(void
 	crypto_unregister_template(&vmac_tmpl);
 }
 
-module_init(vmac_module_init);
+deferred_module_init(vmac_module_init);
 module_exit(vmac_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/wp512.c linux-4.0/crypto/wp512.c
--- linux-4.0.orig/crypto/wp512.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/wp512.c	2015-04-27 16:45:54.150396554 +0100
@@ -1171,7 +1171,7 @@ MODULE_ALIAS_CRYPTO("wp512");
 MODULE_ALIAS_CRYPTO("wp384");
 MODULE_ALIAS_CRYPTO("wp256");
 
-module_init(wp512_mod_init);
+deferred_module_init(wp512_mod_init);
 module_exit(wp512_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/xcbc.c linux-4.0/crypto/xcbc.c
--- linux-4.0.orig/crypto/xcbc.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/xcbc.c	2015-04-27 16:45:54.154396572 +0100
@@ -281,7 +281,7 @@ static void __exit crypto_xcbc_module_ex
 	crypto_unregister_template(&crypto_xcbc_tmpl);
 }
 
-module_init(crypto_xcbc_module_init);
+deferred_module_init(crypto_xcbc_module_init);
 module_exit(crypto_xcbc_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/xts.c linux-4.0/crypto/xts.c
--- linux-4.0.orig/crypto/xts.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/xts.c	2015-04-27 16:45:54.158396596 +0100
@@ -357,7 +357,7 @@ static void __exit crypto_module_exit(vo
 	crypto_unregister_template(&crypto_tmpl);
 }
 
-module_init(crypto_module_init);
+deferred_module_init(crypto_module_init);	//gf128mul
 module_exit(crypto_module_exit);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/crypto/zlib.c linux-4.0/crypto/zlib.c
--- linux-4.0.orig/crypto/zlib.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/crypto/zlib.c	2015-04-27 16:45:54.162396635 +0100
@@ -372,7 +372,7 @@ static void __exit zlib_mod_fini(void)
 	crypto_unregister_pcomp(&zlib_alg);
 }
 
-module_init(zlib_mod_init);
+deferred_module_init(zlib_mod_init);	//zlib_deflate
 module_exit(zlib_mod_fini);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/acpi/ac.c linux-4.0/drivers/acpi/ac.c
--- linux-4.0.orig/drivers/acpi/ac.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/acpi/ac.c	2015-04-27 11:25:03.831152609 +0100
@@ -452,5 +452,5 @@ static void __exit acpi_ac_exit(void)
 	acpi_unlock_ac_dir(acpi_ac_dir);
 #endif
 }
-module_init(acpi_ac_init);
+async_module_init(acpi_ac_init);	//power_supply (subinit)
 module_exit(acpi_ac_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/acpi/acpi_ipmi.c linux-4.0/drivers/acpi/acpi_ipmi.c
--- linux-4.0.orig/drivers/acpi/acpi_ipmi.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/acpi/acpi_ipmi.c	2015-04-27 16:45:54.166396643 +0100
@@ -657,5 +657,5 @@ static void __exit acpi_ipmi_exit(void)
 					  &acpi_ipmi_space_handler);
 }
 
-module_init(acpi_ipmi_init);
+deferred_module_init(acpi_ipmi_init);	//ipmi_msghandler
 module_exit(acpi_ipmi_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/acpi/acpi_pad.c linux-4.0/drivers/acpi/acpi_pad.c
--- linux-4.0.orig/drivers/acpi/acpi_pad.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/acpi/acpi_pad.c	2015-04-27 16:45:54.166396643 +0100
@@ -514,7 +514,7 @@ static void __exit acpi_pad_exit(void)
 	acpi_bus_unregister_driver(&acpi_pad_driver);
 }
 
-module_init(acpi_pad_init);
+deferred_module_init(acpi_pad_init);
 module_exit(acpi_pad_exit);
 MODULE_AUTHOR("Shaohua Li<shaohua.li@intel.com>");
 MODULE_DESCRIPTION("ACPI Processor Aggregator Driver");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/acpi/battery.c linux-4.0/drivers/acpi/battery.c
--- linux-4.0.orig/drivers/acpi/battery.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/acpi/battery.c	2015-04-27 16:45:54.170396652 +0100
@@ -1319,5 +1319,5 @@ static void __exit acpi_battery_exit(voi
 #endif
 }
 
-module_init(acpi_battery_init);
+deferred_module_init(acpi_battery_init);
 module_exit(acpi_battery_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/acpi/processor_driver.c linux-4.0/drivers/acpi/processor_driver.c
--- linux-4.0.orig/drivers/acpi/processor_driver.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/acpi/processor_driver.c	2015-04-27 16:45:54.186396740 +0100
@@ -301,7 +301,7 @@ static void __exit acpi_processor_driver
 	driver_unregister(&acpi_processor_driver);
 }
 
-module_init(acpi_processor_driver_init);
+deferred_module_init(acpi_processor_driver_init);
 module_exit(acpi_processor_driver_exit);
 
 MODULE_ALIAS("processor");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/acpi/sbs.c linux-4.0/drivers/acpi/sbs.c
--- linux-4.0.orig/drivers/acpi/sbs.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/acpi/sbs.c	2015-04-27 16:45:54.186396740 +0100
@@ -755,5 +755,5 @@ static void __exit acpi_sbs_exit(void)
 	return;
 }
 
-module_init(acpi_sbs_init);
+deferred_module_init(acpi_sbs_init);
 module_exit(acpi_sbs_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/acpi/thermal.c linux-4.0/drivers/acpi/thermal.c
--- linux-4.0.orig/drivers/acpi/thermal.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/acpi/thermal.c	2015-04-27 16:45:54.190396760 +0100
@@ -1281,5 +1281,5 @@ static void __exit acpi_thermal_exit(voi
 	return;
 }
 
-module_init(acpi_thermal_init);
+deferred_module_init(acpi_thermal_init);
 module_exit(acpi_thermal_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/acpi/video.c linux-4.0/drivers/acpi/video.c
--- linux-4.0.orig/drivers/acpi/video.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/acpi/video.c	2015-04-27 16:45:54.194396788 +0100
@@ -2203,5 +2203,5 @@ static void __exit acpi_video_exit(void)
 	return;
 }
 
-module_init(acpi_video_init);
+deferred_module_init(acpi_video_init);
 module_exit(acpi_video_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/ata/acard-ahci.c linux-4.0/drivers/ata/acard-ahci.c
--- linux-4.0.orig/drivers/ata/acard-ahci.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/ata/acard-ahci.c	2015-04-21 09:30:19.953724003 +0100
@@ -501,7 +501,7 @@ static int acard_ahci_init_one(struct pc
 	return ahci_host_activate(host, pdev->irq, &acard_ahci_sht);
 }
 
-module_pci_driver(acard_ahci_pci_driver);
+async_module_pci_driver(acard_ahci_pci_driver);
 
 MODULE_AUTHOR("Jeff Garzik");
 MODULE_DESCRIPTION("ACard AHCI SATA low-level driver");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/ata/ahci.c linux-4.0/drivers/ata/ahci.c
--- linux-4.0.orig/drivers/ata/ahci.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/ata/ahci.c	2015-04-21 09:30:19.953724003 +0100
@@ -1465,7 +1465,7 @@ static int ahci_init_one(struct pci_dev
 	return ahci_host_activate(host, pdev->irq, &ahci_sht);
 }
 
-module_pci_driver(ahci_pci_driver);
+async_module_pci_driver(ahci_pci_driver);
 
 MODULE_AUTHOR("Jeff Garzik");
 MODULE_DESCRIPTION("AHCI SATA low-level driver");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/char/agp/backend.c linux-4.0/drivers/char/agp/backend.c
--- linux-4.0.orig/drivers/char/agp/backend.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/char/agp/backend.c	2015-04-27 16:45:54.198396799 +0100
@@ -361,6 +361,6 @@ MODULE_DESCRIPTION("AGP GART driver");
 MODULE_LICENSE("GPL and additional rights");
 MODULE_ALIAS_MISCDEV(AGPGART_MINOR);
 
-module_init(agp_init);
+deferred_module_init(agp_init);
 module_exit(agp_exit);
 
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/char/agp/nvidia-agp.c linux-4.0/drivers/char/agp/nvidia-agp.c
--- linux-4.0.orig/drivers/char/agp/nvidia-agp.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/char/agp/nvidia-agp.c	2015-04-27 16:45:54.206396833 +0100
@@ -468,7 +468,7 @@ static void __exit agp_nvidia_cleanup(vo
 	pci_dev_put(nvidia_private.dev_3);
 }
 
-module_init(agp_nvidia_init);
+deferred_module_init(agp_nvidia_init);
 module_exit(agp_nvidia_cleanup);
 
 MODULE_LICENSE("GPL and additional rights");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/char/hpet.c linux-4.0/drivers/char/hpet.c
--- linux-4.0.orig/drivers/char/hpet.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/char/hpet.c	2015-04-27 16:45:54.210396872 +0100
@@ -1098,7 +1098,7 @@ static void __exit hpet_exit(void)
 	return;
 }
 
-module_init(hpet_init);
+deferred_module_init(hpet_init);
 module_exit(hpet_exit);
 MODULE_AUTHOR("Bob Picco <Robert.Picco@hp.com>");
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/char/ipmi/ipmi_msghandler.c linux-4.0/drivers/char/ipmi/ipmi_msghandler.c
--- linux-4.0.orig/drivers/char/ipmi/ipmi_msghandler.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/char/ipmi/ipmi_msghandler.c	2015-04-21 15:29:15.043971829 +0100
@@ -4607,7 +4607,7 @@ static void __exit cleanup_ipmi(void)
 }
 module_exit(cleanup_ipmi);
 
-module_init(ipmi_init_msghandler_mod);
+module_init(ipmi_init_msghandler_mod);  //release acpi_ipmi, 
 MODULE_LICENSE("GPL");
 MODULE_AUTHOR("Corey Minyard <minyard@mvista.com>");
 MODULE_DESCRIPTION("Incoming and outgoing message routing for an IPMI"
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/cpufreq/cpufreq_conservative.c linux-4.0/drivers/cpufreq/cpufreq_conservative.c
--- linux-4.0.orig/drivers/cpufreq/cpufreq_conservative.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/cpufreq/cpufreq_conservative.c	2015-04-27 16:45:54.210396872 +0100
@@ -403,6 +403,6 @@ MODULE_LICENSE("GPL");
 #ifdef CONFIG_CPU_FREQ_DEFAULT_GOV_CONSERVATIVE
 fs_initcall(cpufreq_gov_dbs_init);
 #else
-module_init(cpufreq_gov_dbs_init);
+deferred_module_init(cpufreq_gov_dbs_init);
 #endif
 module_exit(cpufreq_gov_dbs_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/cpufreq/cpufreq_ondemand.c linux-4.0/drivers/cpufreq/cpufreq_ondemand.c
--- linux-4.0.orig/drivers/cpufreq/cpufreq_ondemand.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/cpufreq/cpufreq_ondemand.c	2015-04-27 16:45:54.222396909 +0100
@@ -626,6 +626,6 @@ MODULE_LICENSE("GPL");
 #ifdef CONFIG_CPU_FREQ_DEFAULT_GOV_ONDEMAND
 fs_initcall(cpufreq_gov_dbs_init);
 #else
-module_init(cpufreq_gov_dbs_init);
+deferred_module_init(cpufreq_gov_dbs_init);
 #endif
 module_exit(cpufreq_gov_dbs_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/cpufreq/cpufreq_powersave.c linux-4.0/drivers/cpufreq/cpufreq_powersave.c
--- linux-4.0.orig/drivers/cpufreq/cpufreq_powersave.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/cpufreq/cpufreq_powersave.c	2015-04-27 16:45:54.226396942 +0100
@@ -59,6 +59,6 @@ MODULE_LICENSE("GPL");
 #ifdef CONFIG_CPU_FREQ_DEFAULT_GOV_POWERSAVE
 fs_initcall(cpufreq_gov_powersave_init);
 #else
-module_init(cpufreq_gov_powersave_init);
+deferred_module_init(cpufreq_gov_powersave_init);
 #endif
 module_exit(cpufreq_gov_powersave_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/cpufreq/cpufreq_stats.c linux-4.0/drivers/cpufreq/cpufreq_stats.c
--- linux-4.0.orig/drivers/cpufreq/cpufreq_stats.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/cpufreq/cpufreq_stats.c	2015-04-27 16:45:54.226396942 +0100
@@ -353,5 +353,5 @@ MODULE_AUTHOR("Zou Nan hai <nanhai.zou@i
 MODULE_DESCRIPTION("Export cpufreq stats via sysfs");
 MODULE_LICENSE("GPL");
 
-module_init(cpufreq_stats_init);
+deferred_module_init(cpufreq_stats_init);
 module_exit(cpufreq_stats_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/cpufreq/cpufreq_userspace.c linux-4.0/drivers/cpufreq/cpufreq_userspace.c
--- linux-4.0.orig/drivers/cpufreq/cpufreq_userspace.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/cpufreq/cpufreq_userspace.c	2015-04-27 16:45:54.230396968 +0100
@@ -118,6 +118,6 @@ MODULE_LICENSE("GPL");
 #ifdef CONFIG_CPU_FREQ_DEFAULT_GOV_USERSPACE
 fs_initcall(cpufreq_gov_userspace_init);
 #else
-module_init(cpufreq_gov_userspace_init);
+deferred_module_init(cpufreq_gov_userspace_init);
 #endif
 module_exit(cpufreq_gov_userspace_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/gpu/drm/Kconfig linux-4.0/drivers/gpu/drm/Kconfig
--- linux-4.0.orig/drivers/gpu/drm/Kconfig	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/gpu/drm/Kconfig	2015-04-14 10:12:41.516068679 +0100
@@ -81,6 +81,8 @@ source "drivers/gpu/drm/i2c/Kconfig"
 
 source "drivers/gpu/drm/bridge/Kconfig"
 
+source "drivers/gpu/drm/nvidia-ion/Kconfig"
+
 config DRM_TDFX
 	tristate "3dfx Banshee/Voodoo3+"
 	depends on DRM && PCI
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/gpu/drm/Makefile linux-4.0/drivers/gpu/drm/Makefile
--- linux-4.0.orig/drivers/gpu/drm/Makefile	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/gpu/drm/Makefile	2015-04-21 09:30:19.957724009 +0100
@@ -32,8 +32,10 @@ obj-$(CONFIG_DRM_KMS_HELPER) += drm_kms_
 
 CFLAGS_drm_trace_points.o := -I$(src)
 
+obj-$(CONFIG_NVIDIA_ION) += nvidia-ion/
 obj-$(CONFIG_DRM)	+= drm.o
 obj-$(CONFIG_DRM_MIPI_DSI) += drm_mipi_dsi.o
+obj-$(CONFIG_NVIDIA_ION)	+= nvidia-ion/
 obj-$(CONFIG_DRM_TTM)	+= ttm/
 obj-$(CONFIG_DRM_TDFX)	+= tdfx/
 obj-$(CONFIG_DRM_R128)	+= r128/
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-cherry.c linux-4.0/drivers/hid/hid-cherry.c
--- linux-4.0.orig/drivers/hid/hid-cherry.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-cherry.c	2015-04-28 15:48:40.885009119 +0100
@@ -63,12 +63,12 @@ static const struct hid_device_id ch_dev
 };
 MODULE_DEVICE_TABLE(hid, ch_devices);
 
-static struct hid_driver ch_driver = {
+static struct hid_driver cherry_driver = {
 	.name = "cherry",
 	.id_table = ch_devices,
 	.report_fixup = ch_report_fixup,
 	.input_mapping = ch_input_mapping,
 };
-module_hid_driver(ch_driver);
+module_hid_driver(cherry_driver);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-chicony.c linux-4.0/drivers/hid/hid-chicony.c
--- linux-4.0.orig/drivers/hid/hid-chicony.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-chicony.c	2015-04-28 15:49:43.677007112 +0100
@@ -65,11 +65,11 @@ static const struct hid_device_id ch_dev
 };
 MODULE_DEVICE_TABLE(hid, ch_devices);
 
-static struct hid_driver ch_driver = {
+static struct hid_driver chicony_driver = {
 	.name = "chicony",
 	.id_table = ch_devices,
 	.input_mapping = ch_input_mapping,
 };
-module_hid_driver(ch_driver);
+module_hid_driver(chicony_driver);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-core.c linux-4.0/drivers/hid/hid-core.c
--- linux-4.0.orig/drivers/hid/hid-core.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-core.c	2015-04-28 15:18:36.994548035 +0100
@@ -2734,7 +2734,7 @@ static void __exit hid_exit(void)
 	bus_unregister(&hid_bus_type);
 }
 
-module_init(hid_init);
+deferred_module_init(hid_init);
 module_exit(hid_exit);
 
 MODULE_AUTHOR("Andreas Gal");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-elo.c linux-4.0/drivers/hid/hid-elo.c
--- linux-4.0.orig/drivers/hid/hid-elo.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-elo.c	2015-04-28 13:54:47.502331633 +0100
@@ -293,7 +293,7 @@ static int __init elo_driver_init(void)
 
 	return ret;
 }
-module_init(elo_driver_init);
+deferred_module_init(elo_driver_init);
 
 static void __exit elo_driver_exit(void)
 {
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-hyperv.c linux-4.0/drivers/hid/hid-hyperv.c
--- linux-4.0.orig/drivers/hid/hid-hyperv.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-hyperv.c	2015-04-28 13:54:43.994331743 +0100
@@ -611,5 +611,5 @@ static void __exit mousevsc_exit(void)
 }
 
 MODULE_LICENSE("GPL");
-module_init(mousevsc_init);
+deferred_module_init(mousevsc_init);
 module_exit(mousevsc_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-roccat-arvo.c linux-4.0/drivers/hid/hid-roccat-arvo.c
--- linux-4.0.orig/drivers/hid/hid-roccat-arvo.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-roccat-arvo.c	2015-04-28 13:54:44.010331737 +0100
@@ -452,7 +452,7 @@ static void __exit arvo_exit(void)
 	class_destroy(arvo_class);
 }
 
-module_init(arvo_init);
+deferred_module_init(arvo_init);
 module_exit(arvo_exit);
 
 MODULE_AUTHOR("Stefan Achatz");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-roccat.c linux-4.0/drivers/hid/hid-roccat.c
--- linux-4.0.orig/drivers/hid/hid-roccat.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-roccat.c	2015-04-28 13:54:44.098331735 +0100
@@ -453,7 +453,7 @@ static void __exit roccat_exit(void)
 	unregister_chrdev_region(dev_id, ROCCAT_MAX_DEVICES);
 }
 
-module_init(roccat_init);
+deferred_module_init(roccat_init);
 module_exit(roccat_exit);
 
 MODULE_AUTHOR("Stefan Achatz");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-roccat-isku.c linux-4.0/drivers/hid/hid-roccat-isku.c
--- linux-4.0.orig/drivers/hid/hid-roccat-isku.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-roccat-isku.c	2015-04-28 13:54:44.014331735 +0100
@@ -454,7 +454,7 @@ static void __exit isku_exit(void)
 	class_destroy(isku_class);
 }
 
-module_init(isku_init);
+deferred_module_init(isku_init);
 module_exit(isku_exit);
 
 MODULE_AUTHOR("Stefan Achatz");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-roccat-kone.c linux-4.0/drivers/hid/hid-roccat-kone.c
--- linux-4.0.orig/drivers/hid/hid-roccat-kone.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-roccat-kone.c	2015-04-28 13:54:44.022331735 +0100
@@ -901,7 +901,7 @@ static void __exit kone_exit(void)
 	class_destroy(kone_class);
 }
 
-module_init(kone_init);
+deferred_module_init(kone_init);
 module_exit(kone_exit);
 
 MODULE_AUTHOR("Stefan Achatz");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-roccat-koneplus.c linux-4.0/drivers/hid/hid-roccat-koneplus.c
--- linux-4.0.orig/drivers/hid/hid-roccat-koneplus.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-roccat-koneplus.c	2015-04-28 13:54:44.030331740 +0100
@@ -570,7 +570,7 @@ static void __exit koneplus_exit(void)
 	class_destroy(koneplus_class);
 }
 
-module_init(koneplus_init);
+deferred_module_init(koneplus_init);
 module_exit(koneplus_exit);
 
 MODULE_AUTHOR("Stefan Achatz");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-roccat-konepure.c linux-4.0/drivers/hid/hid-roccat-konepure.c
--- linux-4.0.orig/drivers/hid/hid-roccat-konepure.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-roccat-konepure.c	2015-04-28 13:54:44.046331736 +0100
@@ -224,7 +224,7 @@ static void __exit konepure_exit(void)
 	class_destroy(konepure_class);
 }
 
-module_init(konepure_init);
+deferred_module_init(konepure_init);
 module_exit(konepure_exit);
 
 MODULE_AUTHOR("Stefan Achatz");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-roccat-kovaplus.c linux-4.0/drivers/hid/hid-roccat-kovaplus.c
--- linux-4.0.orig/drivers/hid/hid-roccat-kovaplus.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-roccat-kovaplus.c	2015-04-28 13:54:44.054331735 +0100
@@ -657,7 +657,7 @@ static void __exit kovaplus_exit(void)
 	class_destroy(kovaplus_class);
 }
 
-module_init(kovaplus_init);
+deferred_module_init(kovaplus_init);
 module_exit(kovaplus_exit);
 
 MODULE_AUTHOR("Stefan Achatz");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-roccat-pyra.c linux-4.0/drivers/hid/hid-roccat-pyra.c
--- linux-4.0.orig/drivers/hid/hid-roccat-pyra.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-roccat-pyra.c	2015-04-28 13:54:44.074331735 +0100
@@ -607,7 +607,7 @@ static void __exit pyra_exit(void)
 	class_destroy(pyra_class);
 }
 
-module_init(pyra_init);
+deferred_module_init(pyra_init);
 module_exit(pyra_exit);
 
 MODULE_AUTHOR("Stefan Achatz");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-roccat-ryos.c linux-4.0/drivers/hid/hid-roccat-ryos.c
--- linux-4.0.orig/drivers/hid/hid-roccat-ryos.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-roccat-ryos.c	2015-04-28 13:54:44.082331735 +0100
@@ -233,7 +233,7 @@ static void __exit ryos_exit(void)
 	class_destroy(ryos_class);
 }
 
-module_init(ryos_init);
+deferred_module_init(ryos_init);
 module_exit(ryos_exit);
 
 MODULE_AUTHOR("Stefan Achatz");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-roccat-savu.c linux-4.0/drivers/hid/hid-roccat-savu.c
--- linux-4.0.orig/drivers/hid/hid-roccat-savu.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-roccat-savu.c	2015-04-28 13:54:44.098331735 +0100
@@ -221,7 +221,7 @@ static void __exit savu_exit(void)
 	class_destroy(savu_class);
 }
 
-module_init(savu_init);
+deferred_module_init(savu_init);
 module_exit(savu_exit);
 
 MODULE_AUTHOR("Stefan Achatz");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/hid-sony.c linux-4.0/drivers/hid/hid-sony.c
--- linux-4.0.orig/drivers/hid/hid-sony.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/hid-sony.c	2015-04-28 13:54:44.122331733 +0100
@@ -2152,7 +2152,7 @@ static void __exit sony_exit(void)
 	hid_unregister_driver(&sony_driver);
 	ida_destroy(&sony_device_id_allocator);
 }
-module_init(sony_init);
+deferred_module_init(sony_init);
 module_exit(sony_exit);
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/uhid.c linux-4.0/drivers/hid/uhid.c
--- linux-4.0.orig/drivers/hid/uhid.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/uhid.c	2015-04-28 13:54:44.126331734 +0100
@@ -775,7 +775,7 @@ static void __exit uhid_exit(void)
 	misc_deregister(&uhid_misc);
 }
 
-module_init(uhid_init);
+deferred_module_init(uhid_init);
 module_exit(uhid_exit);
 MODULE_LICENSE("GPL");
 MODULE_AUTHOR("David Herrmann <dh.herrmann@gmail.com>");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/hid/usbhid/hid-core.c linux-4.0/drivers/hid/usbhid/hid-core.c
--- linux-4.0.orig/drivers/hid/usbhid/hid-core.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/hid/usbhid/hid-core.c	2015-04-28 15:26:31.458533434 +0100
@@ -1626,7 +1626,7 @@ struct usb_interface *usbhid_find_interf
 	return usb_find_interface(&hid_driver, minor);
 }
 
-static int __init hid_init(void)
+static int __init usb_hid_init(void)
 {
 	int retval = -ENOMEM;
 
@@ -1651,7 +1651,7 @@ static void __exit hid_exit(void)
 	usbhid_quirks_exit();
 }
 
-module_init(hid_init);
+deferred_module_init(usb_hid_init);
 module_exit(hid_exit);
 
 MODULE_AUTHOR("Andreas Gal");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/i2c/busses/i2c-nforce2.c linux-4.0/drivers/i2c/busses/i2c-nforce2.c
--- linux-4.0.orig/drivers/i2c/busses/i2c-nforce2.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/i2c/busses/i2c-nforce2.c	2015-04-28 12:51:49.012492495 +0100
@@ -448,4 +448,4 @@ static struct pci_driver nforce2_driver
 	.remove		= nforce2_remove,
 };
 
-module_pci_driver(nforce2_driver);
+deferred_module_pci_driver(nforce2_driver);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/input/keyboard/atkbd.c linux-4.0/drivers/input/keyboard/atkbd.c
--- linux-4.0.orig/drivers/input/keyboard/atkbd.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/input/keyboard/atkbd.c	2015-04-28 10:26:02.197065352 +0100
@@ -1811,5 +1811,5 @@ static void __exit atkbd_exit(void)
 	serio_unregister_driver(&atkbd_drv);
 }
 
-module_init(atkbd_init);
+deferred_module_init(atkbd_init);
 module_exit(atkbd_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/input/misc/uinput.c linux-4.0/drivers/input/misc/uinput.c
--- linux-4.0.orig/drivers/input/misc/uinput.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/input/misc/uinput.c	2015-04-27 16:45:54.270397155 +0100
@@ -939,5 +939,5 @@ MODULE_DESCRIPTION("User level driver su
 MODULE_LICENSE("GPL");
 MODULE_VERSION("0.3");
 
-module_init(uinput_init);
+deferred_module_init(uinput_init);
 module_exit(uinput_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/input/mouse/psmouse-base.c linux-4.0/drivers/input/mouse/psmouse-base.c
--- linux-4.0.orig/drivers/input/mouse/psmouse-base.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/input/mouse/psmouse-base.c	2015-04-27 16:45:54.278397193 +0100
@@ -1894,5 +1894,5 @@ static void __exit psmouse_exit(void)
 	destroy_workqueue(kpsmoused_wq);
 }
 
-module_init(psmouse_init);
+deferred_module_init(psmouse_init);
 module_exit(psmouse_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/input/mousedev.c linux-4.0/drivers/input/mousedev.c
--- linux-4.0.orig/drivers/input/mousedev.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/input/mousedev.c	2015-04-27 16:45:54.282397223 +0100
@@ -1124,5 +1124,5 @@ static void __exit mousedev_exit(void)
 	mousedev_destroy(mousedev_mix);
 }
 
-module_init(mousedev_init);
+deferred_module_init(mousedev_init);
 module_exit(mousedev_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/input/serio/i8042.c linux-4.0/drivers/input/serio/i8042.c
--- linux-4.0.orig/drivers/input/serio/i8042.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/input/serio/i8042.c	2015-04-27 16:45:54.286397239 +0100
@@ -1524,5 +1524,5 @@ static void __exit i8042_exit(void)
 	panic_blink = NULL;
 }
 
-module_init(i8042_init);
+deferred_module_init(i8042_init);
 module_exit(i8042_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/input/serio/serport.c linux-4.0/drivers/input/serio/serport.c
--- linux-4.0.orig/drivers/input/serio/serport.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/input/serio/serport.c	2015-04-27 16:45:54.290397255 +0100
@@ -297,5 +297,5 @@ static void __exit serport_exit(void)
 	tty_unregister_ldisc(N_MOUSE);
 }
 
-module_init(serport_init);
+deferred_module_init(serport_init);
 module_exit(serport_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/Kconfig linux-4.0/drivers/Kconfig
--- linux-4.0.orig/drivers/Kconfig	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/Kconfig	2015-04-21 14:19:27.380902248 +0100
@@ -1,5 +1,20 @@
 menu "Device Drivers"
 
+config ASYNCHRO_MODULE_INIT
+	bool "Initialize module in Asynchronize way using single module dependencies"
+	---help---
+	Asynchrone drivers initialization routine 
+	
+if ASYNCHRO_MODULE_INIT
+	config ASYNCHRO_MODULE_INIT_DEBUG
+	bool "Debug mode"
+	
+	config ASYNCHRO_MODULE_INIT_THREADS	
+	int "Maximum number of threads"
+	range 0 4
+	default "2" 
+endif
+	
 source "drivers/amba/Kconfig"
 
 source "drivers/base/Kconfig"
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/Makefile linux-4.0/drivers/Makefile
--- linux-4.0.orig/drivers/Makefile	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/Makefile	2015-04-21 09:30:19.981724024 +0100
@@ -33,6 +33,9 @@ obj-y				+= amba/
 # really early.
 obj-$(CONFIG_DMADEVICES)	+= dma/
 
+#ready for asyncronized initialization
+obj-y += async.o
+
 # SOC specific infrastructure drivers.
 obj-y				+= soc/
 
@@ -165,3 +168,5 @@ obj-$(CONFIG_RAS)		+= ras/
 obj-$(CONFIG_THUNDERBOLT)	+= thunderbolt/
 obj-$(CONFIG_CORESIGHT)		+= coresight/
 obj-$(CONFIG_ANDROID)		+= android/
+
+
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/net/wireless/b43/main.c linux-4.0/drivers/net/wireless/b43/main.c
--- linux-4.0.orig/drivers/net/wireless/b43/main.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/net/wireless/b43/main.c	2015-04-27 16:45:54.302397323 +0100
@@ -5897,5 +5897,5 @@ static void __exit b43_exit(void)
 	b43_debugfs_exit();
 }
 
-module_init(b43_init)
+deferred_module_init(b43_init)
 module_exit(b43_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/net/wireless/b43legacy/main.c linux-4.0/drivers/net/wireless/b43legacy/main.c
--- linux-4.0.orig/drivers/net/wireless/b43legacy/main.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/net/wireless/b43legacy/main.c	2015-04-27 16:45:54.310397355 +0100
@@ -4061,5 +4061,5 @@ static void __exit b43legacy_exit(void)
 	b43legacy_debugfs_exit();
 }
 
-module_init(b43legacy_init)
+deferred_module_init(b43legacy_init)
 module_exit(b43legacy_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/net/wireless/ipw2x00/ipw2100.c linux-4.0/drivers/net/wireless/ipw2x00/ipw2100.c
--- linux-4.0.orig/drivers/net/wireless/ipw2x00/ipw2100.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/net/wireless/ipw2x00/ipw2100.c	2015-04-27 16:45:54.326397426 +0100
@@ -6611,7 +6611,7 @@ static void __exit ipw2100_exit(void)
 	pm_qos_remove_request(&ipw2100_pm_qos_req);
 }
 
-module_init(ipw2100_init);
+deferred_module_init(ipw2100_init);
 module_exit(ipw2100_exit);
 
 static int ipw2100_wx_get_name(struct net_device *dev,
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/pci/hotplug/pciehp_core.c linux-4.0/drivers/pci/hotplug/pciehp_core.c
--- linux-4.0.orig/drivers/pci/hotplug/pciehp_core.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/pci/hotplug/pciehp_core.c	2015-04-27 16:45:54.334397478 +0100
@@ -383,5 +383,5 @@ static void __exit pcied_cleanup(void)
 	info(DRIVER_DESC " version: " DRIVER_VERSION " unloaded\n");
 }
 
-module_init(pcied_init);
+deferred_module_init(pcied_init);
 module_exit(pcied_cleanup);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/pci/hotplug/pci_hotplug_core.c linux-4.0/drivers/pci/hotplug/pci_hotplug_core.c
--- linux-4.0.orig/drivers/pci/hotplug/pci_hotplug_core.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/pci/hotplug/pci_hotplug_core.c	2015-04-27 16:45:54.330397445 +0100
@@ -545,7 +545,7 @@ static void __exit pci_hotplug_exit(void
 	cpci_hotplug_exit();
 }
 
-module_init(pci_hotplug_init);
+deferred_module_init(pci_hotplug_init);
 module_exit(pci_hotplug_exit);
 
 MODULE_AUTHOR(DRIVER_AUTHOR);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/pci/hotplug/shpchp_core.c linux-4.0/drivers/pci/hotplug/shpchp_core.c
--- linux-4.0.orig/drivers/pci/hotplug/shpchp_core.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/pci/hotplug/shpchp_core.c	2015-04-27 16:45:54.338397504 +0100
@@ -385,5 +385,5 @@ static void __exit shpcd_cleanup(void)
 	info(DRIVER_DESC " version: " DRIVER_VERSION " unloaded\n");
 }
 
-module_init(shpcd_init);
+deferred_module_init(shpcd_init);
 module_exit(shpcd_cleanup);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/pci/pcie/portdrv_pci.c linux-4.0/drivers/pci/pcie/portdrv_pci.c
--- linux-4.0.orig/drivers/pci/pcie/portdrv_pci.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/pci/pcie/portdrv_pci.c	2015-04-27 16:45:54.342397509 +0100
@@ -361,4 +361,4 @@ static int __init pcie_portdrv_init(void
 	return retval;
 }
 
-module_init(pcie_portdrv_init);
+deferred_module_init(pcie_portdrv_init);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/usb/host/ehci-hcd.c linux-4.0/drivers/usb/host/ehci-hcd.c
--- linux-4.0.orig/drivers/usb/host/ehci-hcd.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/usb/host/ehci-hcd.c	2015-04-27 16:45:54.350397545 +0100
@@ -1376,7 +1376,7 @@ err_debug:
 	clear_bit(USB_EHCI_LOADED, &usb_hcds_loaded);
 	return retval;
 }
-module_init(ehci_hcd_init);
+deferred_module_init(ehci_hcd_init);
 
 static void __exit ehci_hcd_cleanup(void)
 {
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/usb/host/ehci-pci.c linux-4.0/drivers/usb/host/ehci-pci.c
--- linux-4.0.orig/drivers/usb/host/ehci-pci.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/usb/host/ehci-pci.c	2015-04-27 16:45:54.354397586 +0100
@@ -421,7 +421,7 @@ static int __init ehci_pci_init(void)
 
 	return pci_register_driver(&ehci_pci_driver);
 }
-module_init(ehci_pci_init);
+deferred_module_init(ehci_pci_init);
 
 static void __exit ehci_pci_cleanup(void)
 {
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/usb/host/ehci-platform.c linux-4.0/drivers/usb/host/ehci-platform.c
--- linux-4.0.orig/drivers/usb/host/ehci-platform.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/usb/host/ehci-platform.c	2015-04-27 16:45:54.358397599 +0100
@@ -428,7 +428,7 @@ static int __init ehci_platform_init(voi
 	ehci_init_driver(&ehci_platform_hc_driver, &platform_overrides);
 	return platform_driver_register(&ehci_platform_driver);
 }
-module_init(ehci_platform_init);
+deferred_module_init(ehci_platform_init);
 
 static void __exit ehci_platform_cleanup(void)
 {
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/usb/host/ohci-hcd.c linux-4.0/drivers/usb/host/ohci-hcd.c
--- linux-4.0.orig/drivers/usb/host/ohci-hcd.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/usb/host/ohci-hcd.c	2015-04-27 16:45:54.362397610 +0100
@@ -1352,7 +1352,7 @@ static int __init ohci_hcd_mod_init(void
 	clear_bit(USB_OHCI_LOADED, &usb_hcds_loaded);
 	return retval;
 }
-module_init(ohci_hcd_mod_init);
+deferred_module_init(ohci_hcd_mod_init);
 
 static void __exit ohci_hcd_mod_exit(void)
 {
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/usb/host/ohci-pci.c linux-4.0/drivers/usb/host/ohci-pci.c
--- linux-4.0.orig/drivers/usb/host/ohci-pci.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/usb/host/ohci-pci.c	2015-04-27 16:45:54.362397610 +0100
@@ -302,7 +302,7 @@ static int __init ohci_pci_init(void)
 
 	return pci_register_driver(&ohci_pci_driver);
 }
-module_init(ohci_pci_init);
+deferred_module_init(ohci_pci_init);
 
 static void __exit ohci_pci_cleanup(void)
 {
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/usb/host/ohci-platform.c linux-4.0/drivers/usb/host/ohci-platform.c
--- linux-4.0.orig/drivers/usb/host/ohci-platform.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/usb/host/ohci-platform.c	2015-04-27 16:45:54.366397621 +0100
@@ -402,7 +402,7 @@ static int __init ohci_platform_init(voi
 	ohci_init_driver(&ohci_platform_hc_driver, &platform_overrides);
 	return platform_driver_register(&ohci_platform_driver);
 }
-module_init(ohci_platform_init);
+deferred_module_init(ohci_platform_init);
 
 static void __exit ohci_platform_cleanup(void)
 {
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/usb/host/ssb-hcd.c linux-4.0/drivers/usb/host/ssb-hcd.c
--- linux-4.0.orig/drivers/usb/host/ssb-hcd.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/usb/host/ssb-hcd.c	2015-04-27 16:45:54.366397621 +0100
@@ -269,7 +269,7 @@ static int __init ssb_hcd_init(void)
 {
 	return ssb_driver_register(&ssb_hcd_driver);
 }
-module_init(ssb_hcd_init);
+deferred_module_init(ssb_hcd_init);
 
 static void __exit ssb_hcd_exit(void)
 {
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/drivers/usb/host/uhci-hcd.c linux-4.0/drivers/usb/host/uhci-hcd.c
--- linux-4.0.orig/drivers/usb/host/uhci-hcd.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/drivers/usb/host/uhci-hcd.c	2015-04-27 16:45:54.370397644 +0100
@@ -937,7 +937,7 @@ static void __exit uhci_hcd_cleanup(void
 	clear_bit(USB_UHCI_LOADED, &usb_hcds_loaded);
 }
 
-module_init(uhci_hcd_init);
+deferred_module_init(uhci_hcd_init);
 module_exit(uhci_hcd_cleanup);
 
 MODULE_AUTHOR(DRIVER_AUTHOR);
Only in linux-4.0/firmware: b43
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/fs/cifs/cifsfs.c linux-4.0/fs/cifs/cifsfs.c
--- linux-4.0.orig/fs/cifs/cifsfs.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/fs/cifs/cifsfs.c	2015-04-27 16:45:54.374397684 +0100
@@ -1314,5 +1314,5 @@ MODULE_DESCRIPTION
     ("VFS to access servers complying with the SNIA CIFS Specification "
      "e.g. Samba and Windows");
 MODULE_VERSION(CIFS_VERSION);
-module_init(init_cifs)
+deferred_module_init(init_cifs)
 module_exit(exit_cifs)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/fs/fat/inode.c linux-4.0/fs/fat/inode.c
--- linux-4.0.orig/fs/fat/inode.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/fs/fat/inode.c	2015-04-27 16:45:54.382397704 +0100
@@ -1855,7 +1855,7 @@ static void __exit exit_fat_fs(void)
 	fat_destroy_inodecache();
 }
 
-module_init(init_fat_fs)
+deferred_module_init(init_fat_fs)
 module_exit(exit_fat_fs)
 
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/fs/fat/namei_msdos.c linux-4.0/fs/fat/namei_msdos.c
--- linux-4.0.orig/fs/fat/namei_msdos.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/fs/fat/namei_msdos.c	2015-04-27 16:45:54.382397704 +0100
@@ -682,5 +682,5 @@ MODULE_LICENSE("GPL");
 MODULE_AUTHOR("Werner Almesberger");
 MODULE_DESCRIPTION("MS-DOS filesystem support");
 
-module_init(init_msdos_fs)
+deferred_module_init(init_msdos_fs)
 module_exit(exit_msdos_fs)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/fs/fat/namei_vfat.c linux-4.0/fs/fat/namei_vfat.c
--- linux-4.0.orig/fs/fat/namei_vfat.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/fs/fat/namei_vfat.c	2015-04-27 16:46:24.546547281 +0100
@@ -1087,5 +1087,5 @@ MODULE_LICENSE("GPL");
 MODULE_DESCRIPTION("VFAT filesystem support");
 MODULE_AUTHOR("Gordon Chaffee");
 
-module_init(init_vfat_fs)
+deferred_module_init(init_vfat_fs)
 module_exit(exit_vfat_fs)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/fs/isofs/inode.c linux-4.0/fs/isofs/inode.c
--- linux-4.0.orig/fs/isofs/inode.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/fs/isofs/inode.c	2015-04-27 16:45:54.386397726 +0100
@@ -1552,6 +1552,6 @@ static void __exit exit_iso9660_fs(void)
 	destroy_inodecache();
 }
 
-module_init(init_iso9660_fs)
+deferred_module_init(init_iso9660_fs)
 module_exit(exit_iso9660_fs)
 MODULE_LICENSE("GPL");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/fs/ntfs/super.c linux-4.0/fs/ntfs/super.c
--- linux-4.0.orig/fs/ntfs/super.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/fs/ntfs/super.c	2015-04-27 16:45:54.398397787 +0100
@@ -3216,5 +3216,5 @@ module_param(debug_msgs, bint, 0);
 MODULE_PARM_DESC(debug_msgs, "Enable debug messages.");
 #endif
 
-module_init(init_ntfs_fs)
+deferred_module_init(init_ntfs_fs)
 module_exit(exit_ntfs_fs)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/include/acpi/acpi_bus.h linux-4.0/include/acpi/acpi_bus.h
--- linux-4.0.orig/include/acpi/acpi_bus.h	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/include/acpi/acpi_bus.h	2015-04-28 16:16:22.006930694 +0100
@@ -501,8 +501,9 @@ static inline bool acpi_device_enumerate
  * use this macro once, and calling it replaces module_init() and module_exit()
  */
 #define module_acpi_driver(__acpi_driver) \
-	module_driver(__acpi_driver, acpi_bus_register_driver, \
-		      acpi_bus_unregister_driver)
+	async_module_driver(__acpi_driver, acpi_bus_register_driver, \
+		      acpi_bus_unregister_driver)  \
+    ADD_MODULE_DEPENDENCY(__acpi_driver##_init, acpi_ac_init);
 
 /*
  * Bind physical devices with ACPI devices
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/include/asm-generic/vmlinux.lds.h linux-4.0/include/asm-generic/vmlinux.lds.h
--- linux-4.0.orig/include/asm-generic/vmlinux.lds.h	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/include/asm-generic/vmlinux.lds.h	2015-04-24 14:48:17.696301594 +0100
@@ -632,6 +632,16 @@
 		*(.initcall##level##.init)				\
 		*(.initcall##level##s.init)				\
 
+#define ASYNC_INITCALLS           \
+   VMLINUX_SYMBOL(__async_initcall_start) = .;    \
+   *(.async_initcall.init)        \
+   VMLINUX_SYMBOL(__async_initcall_end) = .;
+
+#define MODULES_DEPENDENCIES           \
+   VMLINUX_SYMBOL(__async_modules_depends_start) = .;    \
+   *(.async_modules_depends.init)        \
+   VMLINUX_SYMBOL(__async_modules_depends_end) = .;
+
 #define INIT_CALLS							\
 		VMLINUX_SYMBOL(__initcall_start) = .;			\
 		*(.initcallearly.init)					\
@@ -802,9 +812,11 @@
 		INIT_DATA						\
 		INIT_SETUP(initsetup_align)				\
 		INIT_CALLS						\
+		ASYNC_INITCALLS   \
 		CON_INITCALL						\
 		SECURITY_INITCALL					\
 		INIT_RAM_FS						\
+		MODULES_DEPENDENCIES \
 	}
 
 #define BSS_SECTION(sbss_align, bss_align, stop_align)			\
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/include/linux/device.h linux-4.0/include/linux/device.h
--- linux-4.0.orig/include/linux/device.h	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/include/linux/device.h	2015-04-21 09:30:19.997724016 +0100
@@ -13,6 +13,7 @@
 #ifndef _DEVICE_H_
 #define _DEVICE_H_
 
+#include <linux/async_minit.h>
 #include <linux/ioport.h>
 #include <linux/kobject.h>
 #include <linux/klist.h>
@@ -1266,4 +1267,5 @@ static void __exit __driver##_exit(void)
 } \
 module_exit(__driver##_exit);
 
+
 #endif /* _DEVICE_H_ */
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/include/linux/hid.h linux-4.0/include/linux/hid.h
--- linux-4.0.orig/include/linux/hid.h	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/include/linux/hid.h	2015-04-28 14:27:49.681238722 +0100
@@ -782,8 +782,10 @@ extern void hid_unregister_driver(struct
  * use this macro once, and calling it replaces module_init() and module_exit()
  */
 #define module_hid_driver(__hid_driver) \
-	module_driver(__hid_driver, hid_register_driver, \
-		      hid_unregister_driver)
+	deferred_module_driver(__hid_driver, hid_register_driver, \
+		      hid_unregister_driver); \
+     ADD_MODULE_DEPENDENCY(__hid_driver##_init, hid_init);		\
+     ADD_MODULE_DEPENDENCY(__hid_driver##_init, uhid_init);
 
 extern void hidinput_hid_event(struct hid_device *, struct hid_field *, struct hid_usage *, __s32);
 extern void hidinput_report_event(struct hid_device *hid, struct hid_report *report);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/include/linux/module.h linux-4.0/include/linux/module.h
--- linux-4.0.orig/include/linux/module.h	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/include/linux/module.h	2015-04-21 09:30:19.997724016 +0100
@@ -6,6 +6,7 @@
  * Rewritten by Richard Henderson <rth@tamu.edu> Dec 1996
  * Rewritten again by Rusty Russell, 2002
  */
+#include "linux/async_minit.h"
 #include <linux/list.h>
 #include <linux/stat.h>
 #include <linux/compiler.h>
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/include/linux/usb.h linux-4.0/include/linux/usb.h
--- linux-4.0.orig/include/linux/usb.h	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/include/linux/usb.h	2015-04-27 10:52:19.143074780 +0100
@@ -1158,7 +1158,7 @@ extern void usb_deregister(struct usb_dr
  * use this macro once, and calling it replaces module_init() and module_exit()
  */
 #define module_usb_driver(__usb_driver) \
-	module_driver(__usb_driver, usb_register, \
+	async_module_driver(__usb_driver, usb_register, \
 		       usb_deregister)
 
 extern int usb_register_device_driver(struct usb_device_driver *,
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/init/main.c linux-4.0/init/main.c
--- linux-4.0.orig/init/main.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/init/main.c	2015-04-21 09:30:20.001724017 +0100
@@ -928,7 +928,7 @@ static int __ref kernel_init(void *unuse
 	kernel_init_freeable();
 	/* need to finish all async __init code before freeing the memory */
 	async_synchronize_full();
-	free_initmem();
+	//free_initmem();
 	mark_rodata_ro();
 	system_state = SYSTEM_RUNNING;
 	numa_default_policy();
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/.project linux-4.0/.project
--- linux-4.0.orig/.project	2015-04-21 13:50:56.451057744 +0100
+++ linux-4.0/.project	2015-04-14 11:28:19.357432096 +0100
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <projectDescription>
-	<name>linux-4.0.orig</name>
+	<name>linux-4.0</name>
 	<comment></comment>
 	<projects>
 	</projects>
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/compress_offload.c linux-4.0/sound/core/compress_offload.c
--- linux-4.0.orig/sound/core/compress_offload.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/compress_offload.c	2015-04-27 16:45:54.402397798 +0100
@@ -1002,7 +1002,7 @@ static void __exit snd_compress_exit(voi
 {
 }
 
-module_init(snd_compress_init);
+deferred_module_init(snd_compress_init);
 module_exit(snd_compress_exit);
 
 MODULE_DESCRIPTION("ALSA Compressed offload framework");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/hrtimer.c linux-4.0/sound/core/hrtimer.c
--- linux-4.0.orig/sound/core/hrtimer.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/hrtimer.c	2015-04-27 16:45:54.402397798 +0100
@@ -162,5 +162,5 @@ static void __exit snd_hrtimer_exit(void
 	}
 }
 
-module_init(snd_hrtimer_init);
+deferred_module_init(snd_hrtimer_init);
 module_exit(snd_hrtimer_exit);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/hwdep.c linux-4.0/sound/core/hwdep.c
--- linux-4.0.orig/sound/core/hwdep.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/hwdep.c	2015-04-27 16:45:54.406397820 +0100
@@ -548,5 +548,5 @@ static void __exit alsa_hwdep_exit(void)
 	snd_hwdep_proc_done();
 }
 
-module_init(alsa_hwdep_init)
+deferred_module_init(alsa_hwdep_init);
 module_exit(alsa_hwdep_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/oss/mixer_oss.c linux-4.0/sound/core/oss/mixer_oss.c
--- linux-4.0.orig/sound/core/oss/mixer_oss.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/oss/mixer_oss.c	2015-04-27 16:45:54.410397862 +0100
@@ -1418,7 +1418,7 @@ static void __exit alsa_mixer_oss_exit(v
 	}
 }
 
-module_init(alsa_mixer_oss_init)
+deferred_module_init(alsa_mixer_oss_init)
 module_exit(alsa_mixer_oss_exit)
 
 EXPORT_SYMBOL(snd_mixer_oss_ioctl_card);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/oss/pcm_oss.c linux-4.0/sound/core/oss/pcm_oss.c
--- linux-4.0.orig/sound/core/oss/pcm_oss.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/oss/pcm_oss.c	2015-04-27 16:45:54.418397888 +0100
@@ -3108,5 +3108,5 @@ static void __exit alsa_pcm_oss_exit(voi
 	snd_pcm_notify(&snd_pcm_oss_notify, 1);
 }
 
-module_init(alsa_pcm_oss_init)
+deferred_module_init(alsa_pcm_oss_init)
 module_exit(alsa_pcm_oss_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/pcm.c linux-4.0/sound/core/pcm.c
--- linux-4.0.orig/sound/core/pcm.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/pcm.c	2015-04-27 16:45:54.422397904 +0100
@@ -1269,5 +1269,5 @@ static void __exit alsa_pcm_exit(void)
 	snd_pcm_proc_done();
 }
 
-module_init(alsa_pcm_init)
+deferred_module_init(alsa_pcm_init)
 module_exit(alsa_pcm_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/rawmidi.c linux-4.0/sound/core/rawmidi.c
--- linux-4.0.orig/sound/core/rawmidi.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/rawmidi.c	2015-04-27 16:45:54.426397925 +0100
@@ -1739,5 +1739,5 @@ static void __exit alsa_rawmidi_exit(voi
 	snd_ctl_unregister_ioctl_compat(snd_rawmidi_control_ioctl);
 }
 
-module_init(alsa_rawmidi_init)
+deferred_module_init(alsa_rawmidi_init)
 module_exit(alsa_rawmidi_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/rtctimer.c linux-4.0/sound/core/rtctimer.c
--- linux-4.0.orig/sound/core/rtctimer.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/rtctimer.c	2015-04-27 16:45:54.430397956 +0100
@@ -174,7 +174,7 @@ static void __exit rtctimer_exit(void)
 /*
  * exported stuff
  */
-module_init(rtctimer_init)
+deferred_module_init(rtctimer_init)
 module_exit(rtctimer_exit)
 
 module_param(rtctimer_freq, int, 0444);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/seq/oss/seq_oss.c linux-4.0/sound/core/seq/oss/seq_oss.c
--- linux-4.0.orig/sound/core/seq/oss/seq_oss.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/seq/oss/seq_oss.c	2015-04-27 16:45:54.430397956 +0100
@@ -110,7 +110,7 @@ static void __exit alsa_seq_oss_exit(voi
 	unregister_device();
 }
 
-module_init(alsa_seq_oss_init)
+deferred_module_init(alsa_seq_oss_init)
 module_exit(alsa_seq_oss_exit)
 
 /*
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/seq/seq.c linux-4.0/sound/core/seq/seq.c
--- linux-4.0.orig/sound/core/seq/seq.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/seq/seq.c	2015-04-27 16:45:54.462398102 +0100
@@ -134,5 +134,5 @@ static void __exit alsa_seq_exit(void)
 	snd_seq_autoload_exit();
 }
 
-module_init(alsa_seq_init)
+deferred_module_init(alsa_seq_init)
 module_exit(alsa_seq_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/seq/seq_device.c linux-4.0/sound/core/seq/seq_device.c
--- linux-4.0.orig/sound/core/seq/seq_device.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/seq/seq_device.c	2015-04-27 16:45:54.442398007 +0100
@@ -602,7 +602,7 @@ static void __exit alsa_seq_device_exit(
 		pr_err("ALSA: seq: drivers not released (%d)\n", num_ops);
 }
 
-module_init(alsa_seq_device_init)
+deferred_module_init(alsa_seq_device_init)
 module_exit(alsa_seq_device_exit)
 
 EXPORT_SYMBOL(snd_seq_device_load_drivers);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/seq/seq_dummy.c linux-4.0/sound/core/seq/seq_dummy.c
--- linux-4.0.orig/sound/core/seq/seq_dummy.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/seq/seq_dummy.c	2015-04-27 16:45:54.442398007 +0100
@@ -226,5 +226,5 @@ static void __exit alsa_seq_dummy_exit(v
 	delete_client();
 }
 
-module_init(alsa_seq_dummy_init)
+deferred_module_init(alsa_seq_dummy_init)
 module_exit(alsa_seq_dummy_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/seq/seq_midi.c linux-4.0/sound/core/seq/seq_midi.c
--- linux-4.0.orig/sound/core/seq/seq_midi.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/seq/seq_midi.c	2015-04-27 16:45:54.454398071 +0100
@@ -476,5 +476,5 @@ static void __exit alsa_seq_midi_exit(vo
 	snd_seq_device_unregister_driver(SNDRV_SEQ_DEV_ID_MIDISYNTH);
 }
 
-module_init(alsa_seq_midi_init)
+deferred_module_init(alsa_seq_midi_init)
 module_exit(alsa_seq_midi_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/seq/seq_midi_emul.c linux-4.0/sound/core/seq/seq_midi_emul.c
--- linux-4.0.orig/sound/core/seq/seq_midi_emul.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/seq/seq_midi_emul.c	2015-04-27 16:45:54.450398057 +0100
@@ -734,7 +734,7 @@ static void __exit alsa_seq_midi_emul_ex
 {
 }
 
-module_init(alsa_seq_midi_emul_init)
+deferred_module_init(alsa_seq_midi_emul_init)
 module_exit(alsa_seq_midi_emul_exit)
 
 EXPORT_SYMBOL(snd_midi_process_event);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/seq/seq_midi_event.c linux-4.0/sound/core/seq/seq_midi_event.c
--- linux-4.0.orig/sound/core/seq/seq_midi_event.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/seq/seq_midi_event.c	2015-04-27 16:45:54.454398071 +0100
@@ -546,5 +546,5 @@ static void __exit alsa_seq_midi_event_e
 {
 }
 
-module_init(alsa_seq_midi_event_init)
+deferred_module_init(alsa_seq_midi_event_init)
 module_exit(alsa_seq_midi_event_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/seq/seq_virmidi.c linux-4.0/sound/core/seq/seq_virmidi.c
--- linux-4.0.orig/sound/core/seq/seq_virmidi.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/seq/seq_virmidi.c	2015-04-27 16:45:54.458398085 +0100
@@ -537,7 +537,7 @@ static void __exit alsa_virmidi_exit(voi
 {
 }
 
-module_init(alsa_virmidi_init)
+deferred_module_init(alsa_virmidi_init)
 module_exit(alsa_virmidi_exit)
 
 EXPORT_SYMBOL(snd_virmidi_new);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/core/timer.c linux-4.0/sound/core/timer.c
--- linux-4.0.orig/sound/core/timer.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/core/timer.c	2015-04-27 16:45:54.466398133 +0100
@@ -1998,7 +1998,7 @@ static void __exit alsa_timer_exit(void)
 #endif
 }
 
-module_init(alsa_timer_init)
+deferred_module_init(alsa_timer_init)
 module_exit(alsa_timer_exit)
 
 EXPORT_SYMBOL(snd_timer_open);
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/drivers/aloop.c linux-4.0/sound/drivers/aloop.c
--- linux-4.0.orig/sound/drivers/aloop.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/drivers/aloop.c	2015-04-27 16:45:54.470398149 +0100
@@ -1272,5 +1272,5 @@ static void __exit alsa_card_loopback_ex
 	loopback_unregister_all();
 }
 
-module_init(alsa_card_loopback_init)
+deferred_module_init(alsa_card_loopback_init)
 module_exit(alsa_card_loopback_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/drivers/dummy.c linux-4.0/sound/drivers/dummy.c
--- linux-4.0.orig/sound/drivers/dummy.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/drivers/dummy.c	2015-04-27 16:45:54.486398234 +0100
@@ -1219,5 +1219,5 @@ static void __exit alsa_card_dummy_exit(
 	snd_dummy_unregister_all();
 }
 
-module_init(alsa_card_dummy_init)
+deferred_module_init(alsa_card_dummy_init)
 module_exit(alsa_card_dummy_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/drivers/mpu401/mpu401.c linux-4.0/sound/drivers/mpu401/mpu401.c
--- linux-4.0.orig/sound/drivers/mpu401/mpu401.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/drivers/mpu401/mpu401.c	2015-04-27 16:45:54.494398263 +0100
@@ -283,5 +283,5 @@ static void __exit alsa_card_mpu401_exit
 	snd_mpu401_unregister_all();
 }
 
-module_init(alsa_card_mpu401_init)
+deferred_module_init(alsa_card_mpu401_init)
 module_exit(alsa_card_mpu401_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/drivers/mpu401/mpu401_uart.c linux-4.0/sound/drivers/mpu401/mpu401_uart.c
--- linux-4.0.orig/sound/drivers/mpu401/mpu401_uart.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/drivers/mpu401/mpu401_uart.c	2015-04-27 16:45:54.486398234 +0100
@@ -630,5 +630,5 @@ static void __exit alsa_mpu401_uart_exit
 {
 }
 
-module_init(alsa_mpu401_uart_init)
+deferred_module_init(alsa_mpu401_uart_init)
 module_exit(alsa_mpu401_uart_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/drivers/virmidi.c linux-4.0/sound/drivers/virmidi.c
--- linux-4.0.orig/sound/drivers/virmidi.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/drivers/virmidi.c	2015-04-27 16:45:54.494398263 +0100
@@ -195,5 +195,5 @@ static void __exit alsa_card_virmidi_exi
 	snd_virmidi_unregister_all();
 }
 
-module_init(alsa_card_virmidi_init)
+deferred_module_init(alsa_card_virmidi_init)
 module_exit(alsa_card_virmidi_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/oss/soundcard.c linux-4.0/sound/oss/soundcard.c
--- linux-4.0.orig/sound/oss/soundcard.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/oss/soundcard.c	2015-04-27 16:45:54.494398263 +0100
@@ -599,7 +599,7 @@ static void __exit oss_cleanup(void)
 
 }
 
-module_init(oss_init);
+deferred_module_init(oss_init);
 module_exit(oss_cleanup);
 MODULE_LICENSE("GPL");
 MODULE_DESCRIPTION("OSS Sound subsystem");
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_analog.c linux-4.0/sound/pci/hda/patch_analog.c
--- linux-4.0.orig/sound/pci/hda/patch_analog.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_analog.c	2015-04-27 16:45:54.498398285 +0100
@@ -1209,5 +1209,5 @@ static void __exit patch_analog_exit(voi
 	snd_hda_delete_codec_preset(&analog_list);
 }
 
-module_init(patch_analog_init)
+deferred_module_init(patch_analog_init)
 module_exit(patch_analog_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_ca0110.c linux-4.0/sound/pci/hda/patch_ca0110.c
--- linux-4.0.orig/sound/pci/hda/patch_ca0110.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_ca0110.c	2015-04-27 16:45:54.502398315 +0100
@@ -113,5 +113,5 @@ static void __exit patch_ca0110_exit(voi
 	snd_hda_delete_codec_preset(&ca0110_list);
 }
 
-module_init(patch_ca0110_init)
+deferred_module_init(patch_ca0110_init)
 module_exit(patch_ca0110_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_ca0132.c linux-4.0/sound/pci/hda/patch_ca0132.c
--- linux-4.0.orig/sound/pci/hda/patch_ca0132.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_ca0132.c	2015-04-27 16:45:54.510398347 +0100
@@ -4717,5 +4717,5 @@ static void __exit patch_ca0132_exit(voi
 	snd_hda_delete_codec_preset(&ca0132_list);
 }
 
-module_init(patch_ca0132_init)
+deferred_module_init(patch_ca0132_init)
 module_exit(patch_ca0132_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_cirrus.c linux-4.0/sound/pci/hda/patch_cirrus.c
--- linux-4.0.orig/sound/pci/hda/patch_cirrus.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_cirrus.c	2015-04-27 16:45:54.514398364 +0100
@@ -1236,5 +1236,5 @@ static void __exit patch_cirrus_exit(voi
 	snd_hda_delete_codec_preset(&cirrus_list);
 }
 
-module_init(patch_cirrus_init)
+deferred_module_init(patch_cirrus_init)
 module_exit(patch_cirrus_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_cmedia.c linux-4.0/sound/pci/hda/patch_cmedia.c
--- linux-4.0.orig/sound/pci/hda/patch_cmedia.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_cmedia.c	2015-04-27 16:45:54.514398364 +0100
@@ -152,5 +152,5 @@ static void __exit patch_cmedia_exit(voi
 	snd_hda_delete_codec_preset(&cmedia_list);
 }
 
-module_init(patch_cmedia_init)
+deferred_module_init(patch_cmedia_init)
 module_exit(patch_cmedia_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_conexant.c linux-4.0/sound/pci/hda/patch_conexant.c
--- linux-4.0.orig/sound/pci/hda/patch_conexant.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_conexant.c	2015-04-27 16:45:54.518398383 +0100
@@ -1033,5 +1033,5 @@ static void __exit patch_conexant_exit(v
 	snd_hda_delete_codec_preset(&conexant_list);
 }
 
-module_init(patch_conexant_init)
+deferred_module_init(patch_conexant_init)
 module_exit(patch_conexant_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_hdmi.c linux-4.0/sound/pci/hda/patch_hdmi.c
--- linux-4.0.orig/sound/pci/hda/patch_hdmi.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_hdmi.c	2015-04-27 16:45:54.534398463 +0100
@@ -3457,5 +3457,5 @@ static void __exit patch_hdmi_exit(void)
 	snd_hda_delete_codec_preset(&intel_list);
 }
 
-module_init(patch_hdmi_init)
+deferred_module_init(patch_hdmi_init)
 module_exit(patch_hdmi_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_realtek.c linux-4.0/sound/pci/hda/patch_realtek.c
--- linux-4.0.orig/sound/pci/hda/patch_realtek.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_realtek.c	2015-04-27 16:45:54.554398566 +0100
@@ -6564,5 +6564,5 @@ static void __exit patch_realtek_exit(vo
 	snd_hda_delete_codec_preset(&realtek_list);
 }
 
-module_init(patch_realtek_init)
+deferred_module_init(patch_realtek_init)
 module_exit(patch_realtek_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_si3054.c linux-4.0/sound/pci/hda/patch_si3054.c
--- linux-4.0.orig/sound/pci/hda/patch_si3054.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_si3054.c	2015-04-27 16:45:54.558398575 +0100
@@ -334,5 +334,5 @@ static void __exit patch_si3054_exit(voi
 	snd_hda_delete_codec_preset(&si3054_list);
 }
 
-module_init(patch_si3054_init)
+deferred_module_init(patch_si3054_init)
 module_exit(patch_si3054_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_sigmatel.c linux-4.0/sound/pci/hda/patch_sigmatel.c
--- linux-4.0.orig/sound/pci/hda/patch_sigmatel.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_sigmatel.c	2015-04-27 16:45:54.566398620 +0100
@@ -5106,5 +5106,5 @@ static void __exit patch_sigmatel_exit(v
 	snd_hda_delete_codec_preset(&sigmatel_list);
 }
 
-module_init(patch_sigmatel_init)
+deferred_module_init(patch_sigmatel_init)
 module_exit(patch_sigmatel_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/pci/hda/patch_via.c linux-4.0/sound/pci/hda/patch_via.c
--- linux-4.0.orig/sound/pci/hda/patch_via.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/pci/hda/patch_via.c	2015-04-27 16:45:54.570398659 +0100
@@ -1902,5 +1902,5 @@ static void __exit patch_via_exit(void)
 	snd_hda_delete_codec_preset(&via_list);
 }
 
-module_init(patch_via_init)
+deferred_module_init(patch_via_init)
 module_exit(patch_via_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/ppc/powermac.c linux-4.0/sound/ppc/powermac.c
--- linux-4.0.orig/sound/ppc/powermac.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/ppc/powermac.c	2015-04-27 16:45:54.574398670 +0100
@@ -190,5 +190,5 @@ static void __exit alsa_card_pmac_exit(v
 	platform_driver_unregister(&snd_pmac_driver);
 }
 
-module_init(alsa_card_pmac_init)
+deferred_module_init(alsa_card_pmac_init)
 module_exit(alsa_card_pmac_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/ppc/snd_ps3.c linux-4.0/sound/ppc/snd_ps3.c
--- linux-4.0.orig/sound/ppc/snd_ps3.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/ppc/snd_ps3.c	2015-04-27 16:45:54.578398677 +0100
@@ -1147,7 +1147,7 @@ static int __init snd_ps3_init(void)
 
 	return ret;
 }
-module_init(snd_ps3_init);
+deferred_module_init(snd_ps3_init);
 
 static void __exit snd_ps3_exit(void)
 {
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/synth/emux/emux.c linux-4.0/sound/synth/emux/emux.c
--- linux-4.0.orig/sound/synth/emux/emux.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/synth/emux/emux.c	2015-04-27 16:45:54.582398695 +0100
@@ -182,5 +182,5 @@ static void __exit alsa_emux_exit(void)
 {
 }
 
-module_init(alsa_emux_init)
+deferred_module_init(alsa_emux_init)
 module_exit(alsa_emux_exit)
diff -rup -x Documentation -x '*.o' -x bzImage '--exclude=.cproject' '--exclude=build' '--exclude=drivers/gpu/drm/nvidia-ion' linux-4.0.orig/sound/synth/util_mem.c linux-4.0/sound/synth/util_mem.c
--- linux-4.0.orig/sound/synth/util_mem.c	2015-04-12 23:12:50.000000000 +0100
+++ linux-4.0/sound/synth/util_mem.c	2015-04-27 16:45:54.582398695 +0100
@@ -207,5 +207,5 @@ static void __exit alsa_util_mem_exit(vo
 {
 }
 
-module_init(alsa_util_mem_init)
+deferred_module_init(alsa_util_mem_init)
 module_exit(alsa_util_mem_exit)
